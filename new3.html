<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××¢×¨×›×ª × ×™×”×•×œ ××›×•×œ×•×ª - ××©×•×“×¨×’</title>
    <!-- Tailwind CSS for modern styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts - Assistant for a clean Hebrew font -->
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Base styles */
        body {
            font-family: 'Assistant', sans-serif;
            background-color: #f8fafc; /* gray-50 */
        }
        /* Navigation tab button styling */
        .nav-tab-btn {
            transition: all 0.3s ease;
            border-bottom: 4px solid transparent;
            position: relative;
            overflow: hidden;
            flex-grow: 1; /* Make buttons take equal width */
            text-align: center;
        }
        /* Active navigation tab button styling */
        .nav-tab-btn.active {
            border-bottom-color: #8b5cf6; /* violet-500 */
            color: #6d28d9; /* violet-700 */
        }
        /* Hover effect for inactive navigation tab buttons */
        .nav-tab-btn:not(.active):hover {
            color: #6d28d9;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(139, 92, 246, 0.3);
            background-color: rgba(139, 92, 246, 0.05);
            border-radius: 0.5rem;
        }

        /* KPI card styling */
        .kpi-card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            padding: 1.5rem;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        /* Hover effect for KPI cards */
        .kpi-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        /* Modal overlay styling */
        .modal-overlay {
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 50;
            backdrop-filter: blur(5px); /* Blurred background for modal */
            animation: fadeIn 0.3s ease-out;
        }
        /* Modal content styling */
        .modal-content {
            max-height: 90vh;
            animation: slideInFromTop 0.3s ease-out;
            transform-origin: top;
        }
        /* Chart container styling for responsiveness */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 40vh;
            max-height: 400px;
        }
        /* Kanban column styling */
        .kanban-column {
            min-height: 200px;
        }
        /* Status badge styling */
        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-weight: 600;
            font-size: 0.8rem;
        }
        /* Specific status badge colors */
        .status-green { background-color: #dcfce7; color: #166534; }
        .status-yellow { background-color: #fef9c3; color: #854d0e; }
        .status-red { background-color: #fee2e2; color: #991b1b; }
        .status-gray { background-color: #f3f4f6; color: #4b5563; }
        .status-blue { background-color: #e0f2fe; color: #075985; } /* For 'in_transit' */

        /* Custom styles for larger and bolder table text */
        .table-large-text td { 
            font-size: 1.1rem; 
            font-weight: 700;
        }
        /* Typing effect cursor styling */
        .typing-effect-cursor {
            display: inline-block;
            width: 2px;
            height: 1.2em;
            background-color: black;
            animation: blink-caret 0.75s step-end infinite;
            vertical-align: middle;
        }
        /* Keyframe animation for blinking cursor */
        @keyframes blink-caret {
            from, to { background-color: transparent }
            50% { background-color: black }
        }

        /* Animations for modals */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideInFromTop {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* Loading spinner styles */
        .loader {
            border: 4px solid #f3f3f3; /* Light grey */
            border-top: 4px solid #6d28d9; /* Violet */
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* New blink-subtle animation for overdue KPI */
        @keyframes blink-subtle {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        .blink-subtle {
            animation: blink-subtle 1.5s ease-in-out infinite;
        }
        /* Style for clickable container numbers */
        .container-link {
            text-decoration: underline;
            color: #3b82f6; /* blue-500 */
            cursor: pointer;
            transition: opacity 0.2s ease;
        }
        .container-link:hover {
            opacity: 0.8;
        }
        /* Styling for the note input within KPI card */
        .kpi-note-input {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #d1d5db; /* gray-300 */
            border-radius: 0.375rem; /* rounded-md */
            margin-top: 0.5rem;
            box-shadow: inset 0 1px 2px rgba(0,0,0,0.05);
            transition: all 0.2s ease;
        }
        .kpi-note-input:focus {
            outline: none;
            border-color: #8b5cf6; /* violet-500 */
            box-shadow: 0 0 0 2px rgba(139, 92, 246, 0.25); /* ring-violet-300 */
        }
        /* Styling for scrollable notes */
        .scrollable-notes {
            max-height: 3.5rem; /* ~2-3 lines of text */
            overflow-y: auto;
            word-wrap: break-word; /* Ensure long words break */
            scrollbar-width: thin; /* Firefox */
            scrollbar-color: #d1d5db #f3f4f6; /* Thumb and track color */
        }
        /* Webkit scrollbar (Chrome, Safari) */
        .scrollable-notes::-webkit-scrollbar {
            width: 6px;
        }
        .scrollable-notes::-webkit-scrollbar-track {
            background: #f3f4f6;
            border-radius: 10px;
        }
        .scrollable-notes::-webkit-scrollbar-thumb {
            background-color: #d1d5db;
            border-radius: 10px;
            border: 2px solid #f3f4f6;
        }
    </style>
</head>
<body class="antialiased text-gray-800">

    <!-- Main Container -->
    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        
        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">××¢×¨×›×ª × ×™×”×•×œ ××›×•×œ×•×ª</h1>
            <p class="text-lg text-gray-600">×œ×•×— ×‘×§×¨×” ××¨×›×–×™ ×œ× ×™×”×•×œ, ××¢×§×‘ ×•× ×™×ª×•×— ×¤×¢×™×œ×•×ª</p>
        </header>

        <!-- Top 3 Overdue Customers KPI Cards -->
        <section id="overdue-kpis" class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"></section>

        <!-- Navigation Tabs -->
        <nav class="flex justify-center border-b-2 border-gray-200 mb-8 rounded-lg shadow-sm">
            <button id="nav-dashboard" class="nav-tab-btn active text-lg font-semibold px-6 py-3 rounded-t-lg" onclick="showPage('dashboard')">
                <i class="fas fa-tachometer-alt mr-2"></i>×œ×•×— ×‘×§×¨×”
            </button>
            <button id="nav-inventory" class="nav-tab-btn text-lg font-semibold px-6 py-3 rounded-t-lg" onclick="showPage('inventory')">
                <i class="fas fa-boxes-stacked mr-2"></i>××œ××™ ××›×•×œ×•×ª
            </button>
            <button id="nav-treatment" class="nav-tab-btn text-lg font-semibold px-6 py-3 rounded-t-lg" onclick="showPage('treatment')">
                <i class="fas fa-clipboard-check mr-2"></i>×œ×•×— ×˜×™×¤×•×œ ×‘×—×¨×™×’×•×ª
            </button>
        </nav>

        <!-- Page Content -->
        <main>
            <!-- Dashboard Page -->
            <section id="page-dashboard" class="space-y-8">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold text-gray-700">×¡×§×™×¨×” ×›×œ×œ×™×ª</h2>
                    <button onclick="openNewOrderModal()" class="px-4 py-2 bg-blue-600 text-white rounded-lg shadow-md hover:bg-blue-700 transition-colors flex items-center">
                        <i class="fas fa-plus-circle mr-2"></i>×”×–×× ×” ×—×“×©×”
                    </button>
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div class="kpi-card">
                        <h3 class="text-gray-500 font-semibold">××›×•×œ×•×ª ×¤×¢×™×œ×•×ª ×‘××ª×¨×™×</h3>
                        <p id="kpi-active-containers" class="text-4xl font-bold text-blue-600 mt-2">0</p>
                    </div>
                    <div class="kpi-card">
                        <h3 class="text-gray-500 font-semibold">×œ×§×•×—×•×ª ×‘×—×¨×™×’×” <span class="text-xs">(××¢×œ 10 ×™××™×)</span></h3>
                        <p id="kpi-overdue-customers" class="text-4xl font-bold text-red-600 mt-2">0</p>
                    </div>
                    <div class="kpi-card">
                        <h3 class="text-gray-500 font-semibold">××›×•×œ×•×ª ×¤× ×•×™×•×ª ×‘××œ××™</h3>
                        <p id="kpi-available-containers" class="text-4xl font-bold text-green-600 mt-2">0</p>
                    </div>
                    <div class="kpi-card">
                        <h3 class="text-gray-500 font-semibold">×¡×”"×› ×¤×¢×•×œ×•×ª (×›×œ ×”×–×× ×™×)</h3>
                        <p id="kpi-total-operations" class="text-4xl font-bold text-gray-700 mt-2">0</p>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="kpi-card">
                        <h3 class="text-xl font-bold text-gray-700 mb-4">×¤×¢×™×œ×•×ª ×œ×¤×™ ×¡×•×›×Ÿ</h3>
                        <div class="chart-container">
                            <canvas id="agentActivityChart"></canvas>
                        </div>
                    </div>
                    <div class="kpi-card">
                        <h3 class="text-xl font-bold text-gray-700 mb-4">×¤×¢×•×œ×•×ª ×œ××•×¨×š ×–××Ÿ</h3>
                         <div class="chart-container">
                            <canvas id="operationsTimelineChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="kpi-card">
                    <h2 class="text-2xl font-bold text-gray-700 mb-4">×›×œ×œ ×”×¤×¢×•×œ×•×ª</h2>
                     <div class="flex items-center mb-4">
                        <i class="fas fa-search text-gray-400 mr-3"></i>
                        <input type="text" id="main-search" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-300 focus:border-violet-500 transition-all" placeholder="×—×¤×© ×œ×¤×™ ×©× ×œ×§×•×—, ×ª×¢×•×“×”, ×©× ×¡×•×›×Ÿ, ××¡×¤×¨ ××›×•×œ×”...">
                    </div>
                    <!-- New filter for closed orders -->
                    <div class="mb-4 flex items-center">
                        <input type="checkbox" id="show-closed-orders" class="ml-2 h-5 w-5 text-violet-600 focus:ring-violet-500 border-gray-300 rounded">
                        <label for="show-closed-orders" class="text-gray-700 font-medium">×”×¦×’ ×”×–×× ×•×ª ×¡×’×•×¨×•×ª</label>
                    </div>
                    <div class="overflow-x-auto rounded-lg shadow-sm border border-gray-200">
                        <table class="min-w-full bg-white">
                            <thead class="bg-gray-100">
                                <tr class="border-b border-gray-200">
                                    <th class="py-3 px-4 text-right font-bold text-gray-600">×ª××¨×™×š ğŸ“…</th>
                                    <th class="py-3 px-4 text-right font-bold text-gray-600">×ª×¢×•×“×” ğŸ“„</th>
                                    <th class="py-3 px-4 text-right font-bold text-gray-600">×©× ×œ×§×•×— ğŸ‘¤</th>
                                    <th class="py-3 px-4 text-right font-bold text-gray-600">×©× ×¡×•×›×Ÿ ğŸ‘·</th>
                                    <th class="py-3 px-4 text-right font-bold text-gray-600">×¡×•×’ ×¤×¢×•×œ×” ğŸ“¦</th>
                                    <th class="py-3 px-4 text-right font-bold text-gray-600">×™××™× ×‘×©×›×™×¨×•×ª â³</th>
                                    <th class="py-3 px-4 text-right font-bold text-gray-600">××›×•×œ×” ğŸ”¢</th>
                                    <th class="py-3 px-4 text-right font-bold text-gray-600">×¡×˜×˜×•×¡ âœ…</th>
                                    <th class="py-3 px-4 text-right font-bold text-gray-600">×¤×¢×•×œ×•×ª ğŸ› ï¸</th>
                                </tr>
                            </thead>
                            <tbody id="all-operations-table" class="table-large-text divide-y divide-gray-200">
                                <!-- Data will be populated by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Inventory Page -->
            <section id="page-inventory" class="hidden space-y-8">
                 <div class="kpi-card">
                    <h2 class="text-2xl font-bold text-gray-700 mb-4">××›×•×œ×•×ª ×‘×©×™××•×© ×¤×¢×™×œ</h2>
                    <div class="overflow-x-auto rounded-lg shadow-sm border border-gray-200">
                        <table class="min-w-full bg-white">
                            <thead class="bg-gray-100">
                                <tr class="border-b border-gray-200">
                                    <th class="py-3 px-4 text-right font-bold text-gray-600">××¡×¤×¨ ××›×•×œ×” ğŸ”¢</th>
                                    <th class="py-3 px-4 text-right font-bold text-gray-600">×¡×˜×˜×•×¡ ××›×•×œ×” ğŸš§</th>
                                    <th class="py-3 px-4 text-right font-bold text-gray-600">×œ×§×•×— × ×•×›×—×™ ğŸ‘¤</th>
                                    <th class="py-3 px-4 text-right font-bold text-gray-600">×ª××¨×™×š ×”×¦×‘×” ğŸ—“ï¸</th>
                                    <th class="py-3 px-4 text-right font-bold text-gray-600">×™××™× ×‘××ª×¨ â³</th>
                                    <th class="py-3 px-4 text-right font-bold text-gray-600">×¤×¢×•×œ×•×ª ğŸ› ï¸</th>
                                </tr>
                            </thead>
                            <tbody id="in-use-containers-table" class="table-large-text divide-y divide-gray-200">
                                <!-- Data will be populated by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
                 <div class="kpi-card">
                    <h2 class="text-2xl font-bold text-gray-700 mb-4">××›×•×œ×•×ª ×¤× ×•×™×•×ª / ×‘×ª×”×œ×™×š</h2>
                     <div class="overflow-x-auto rounded-lg shadow-sm border border-gray-200">
                        <table class="min-w-full bg-white">
                            <thead class="bg-gray-100">
                                <tr class="border-b border-gray-200">
                                    <th class="py-3 px-4 text-right font-bold text-gray-600">××¡×¤×¨ ××›×•×œ×” ğŸ”¢</th>
                                    <th class="py-3 px-4 text-right font-bold text-gray-600">×¡×˜×˜×•×¡ ××›×•×œ×” ğŸš§</th>
                                    <th class="py-3 px-4 text-right font-bold text-gray-600">×ª××¨×™×š ×¤×¢×•×œ×” ××—×¨×•× ×” ğŸ—“ï¸</th>
                                    <th class="py-3 px-4 text-right font-bold text-gray-600">×œ×§×•×—/×™×¢×“ ××—×¨×•×Ÿ ğŸ‘¤</th>
                                    <th class="py-3 px-4 text-right font-bold text-gray-600">×¤×¢×•×œ×•×ª ğŸ› ï¸</th>
                                </tr>
                            </thead>
                            <tbody id="available-containers-table" class="table-large-text divide-y divide-gray-200">
                                <!-- Data will be populated by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Treatment Page -->
            <section id="page-treatment" class="hidden">
                 <h2 class="text-2xl font-bold text-gray-700 mb-4">×œ×•×— ×˜×™×¤×•×œ ×‘×œ×§×•×—×•×ª ×—×•×¨×’×™×</h2>
                 <p class="text-gray-600 mb-6">×›××Ÿ ××¨×•×›×–×•×ª ×›×œ ×”××›×•×œ×•×ª ×©× ××¦××•×ª ××¦×œ ×œ×§×•×—×•×ª ××¢×œ 10 ×™××™ ×¢×‘×•×“×” ×•×“×•×¨×©×•×ª ×˜×™×¤×•×œ (×”×—×œ×¤×” ××• ×”×•×¦××”).</p>
                 <div id="treatment-board" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Kanban columns will be populated by JS -->
                 </div>
                 <div id="no-overdue-message" class="text-center text-gray-600 col-span-full hidden mt-8 p-4 bg-white rounded-lg shadow-md">
                     <p class="text-xl font-semibold mb-2">××™×Ÿ ×œ×§×•×—×•×ª ×‘×—×¨×™×’×” ×›×¨×’×¢. ×›×œ ×”×›×‘×•×“! ğŸ‰</p>
                     <p>×”×¦×•×•×ª ×¢×•×‘×“ × ×”×“×¨!</p>
                 </div>
            </section>
        </main>
    </div>

    <!-- Global Loading Spinner -->
    <div id="global-loader" class="fixed inset-0 bg-gray-100 bg-opacity-75 flex items-center justify-center hidden z-[100]">
        <div class="loader"></div>
        <p class="text-gray-700 text-lg mt-4 mr-4">×˜×•×¢×Ÿ × ×ª×•× ×™×...</p>
    </div>

    <!-- Unified History Modal (for Customer and Container) -->
    <div id="customer-history-modal" class="fixed inset-0 modal-overlay hidden items-center justify-center">
        <div class="modal-content bg-white rounded-lg shadow-2xl w-11/12 max-w-4xl overflow-y-auto">
            <div class="p-6 border-b flex justify-between items-center bg-gray-50 rounded-t-lg">
                <h2 class="text-2xl font-bold" id="modal-history-title"></h2>
                <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700 text-3xl font-light leading-none">&times;</button>
            </div>
            <div class="p-6">
                <div id="modal-customer-specific-details">
                    <h3 class="text-lg font-semibold mb-2 text-gray-700">×¡×™×›×•× ×¤×¢×™×œ×•×ª</h3>
                    <div id="modal-customer-summary" class="grid grid-cols-3 gap-4 mb-6 bg-blue-50 p-4 rounded-md text-blue-800 font-medium"></div>
                    <h3 class="text-lg font-semibold mb-2 text-gray-700">××›×•×œ×•×ª ×©×©×•×™×›×• ×œ×œ×§×•×—</h3>
                    <div id="modal-customer-containers" class="mb-6 p-3 bg-gray-50 rounded-md text-gray-700">
                        <p id="customer-container-list" class="font-mono text-sm"></p>
                    </div>
                </div>
                <h3 class="text-lg font-semibold mb-2 text-gray-700" id="history-table-title">×”×™×¡×˜×•×¨×™×™×ª ×¤×¢×•×œ×•×ª</h3>
                <div class="overflow-y-auto max-h-96 rounded-md border border-gray-200">
                    <table class="min-w-full">
                        <thead class="bg-gray-50 sticky top-0">
                            <tr id="history-table-header-row" class="border-b border-gray-200">
                                <!-- Headers will be dynamically populated -->
                            </tr>
                        </thead>
                        <tbody id="modal-customer-history-table" class="table-large-text divide-y divide-gray-200"></tbody>
                    </table>
                </div>
            </div>
            <div class="p-4 bg-gray-50 text-left rounded-b-lg">
                <button onclick="closeModal()" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors">×¡×’×•×¨</button>
            </div>
        </div>
    </div>

    <!-- WhatsApp Message Modal -->
    <div id="whatsapp-modal" class="fixed inset-0 modal-overlay hidden items-center justify-center">
        <div class="modal-content bg-white rounded-lg shadow-2xl w-11/12 max-w-xl">
            <div class="p-6 border-b flex justify-between items-center bg-gray-50 rounded-t-lg">
                <h2 class="text-2xl font-bold">×©×œ×™×—×ª ×”×•×“×¢×ª WhatsApp</h2>
                <button onclick="closeModalWhatsApp()" class="text-gray-500 hover:text-gray-700 text-3xl font-light leading-none">&times;</button>
            </div>
            <div class="p-6">
                <div class="mb-4">
                    <label for="whatsapp-phone-input" class="block text-sm font-semibold text-gray-700 mb-1">××¡×¤×¨ ×˜×œ×¤×•×Ÿ:</label>
                    <input type="text" id="whatsapp-phone-input" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-300 focus:border-green-500 transition-all" placeholder="9725XXXXXXXX">
                    <p id="phone-error" class="text-red-500 text-sm mt-1 hidden">××¡×¤×¨ ×˜×œ×¤×•×Ÿ ××™× ×• ×ª×§×™×Ÿ.</p>
                </div>
                 <div class="mb-4">
                    <button onclick="toggleMessageOptions()" class="w-full text-right bg-gray-100 p-3 rounded-md font-semibold text-gray-700 flex justify-between items-center hover:bg-gray-200 transition-colors">
                        <span>×‘×—×¨ ×”×•×“×¢×” ××•×‘× ×™×ª</span>
                        <i id="message-options-toggle-icon" class="fas fa-chevron-down transform transition-transform"></i>
                    </button>
                    <div id="whatsapp-message-options-container" class="hidden mt-2 border border-gray-200 rounded-md max-h-60 overflow-y-auto bg-white shadow-inner">
                        <input type="text" id="message-filter-input" class="w-full p-2 border-b border-gray-200 sticky top-0 bg-white" placeholder="×—×¤×© ×”×•×“×¢×”..." onkeyup="filterMessageOptions()">
                        <div id="message-options-list"></div>
                    </div>
                </div>
                <div class="mb-4">
                    <label for="whatsapp-message-textarea" class="block text-sm font-semibold text-gray-700 mb-1">×ª×•×›×Ÿ ×”×”×•×“×¢×”:</label>
                     <div class="border border-gray-300 rounded-md p-3 min-h-[100px] bg-gray-50 mb-2 overflow-y-auto max-h-48 relative">
                        <span id="typing-effect-display" class="whitespace-pre-wrap text-gray-800"></span><span class="typing-effect-cursor">|</span>
                    </div>
                    <textarea id="whatsapp-message-textarea" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-300 focus:border-green-500 transition-all" rows="5" placeholder="×›×ª×•×‘ ×›××Ÿ ×”×•×“×¢×” ××™×©×™×ª..."></textarea>
                </div>
                <input type="hidden" id="whatsapp-doc-id">
                <input type="hidden" id="whatsapp-customer-id"> <!-- Added for note updates -->
                <div class="flex justify-end">
                    <button onclick="sendWhatsAppMessage()" class="px-4 py-2 bg-green-500 text-white rounded-lg shadow-md hover:bg-green-600 transition-colors flex items-center">
                        <i class="fab fa-whatsapp mr-2"></i>×©×œ×— ×”×•×“×¢×”
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- New Order Modal -->
    <div id="new-order-modal" class="fixed inset-0 modal-overlay hidden items-center justify-center">
        <div class="modal-content bg-white rounded-lg shadow-2xl w-11/12 max-w-2xl overflow-y-auto">
            <div class="p-6 border-b flex justify-between items-center bg-gray-50 rounded-t-lg">
                <h2 class="text-2xl font-bold">×”×•×¡×¤×ª ×”×–×× ×” ×—×“×©×”</h2>
                <button onclick="closeNewOrderModal()" class="text-gray-500 hover:text-gray-700 text-3xl font-light leading-none">&times;</button>
            </div>
            <div class="p-6">
                <form id="new-order-form" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="col-span-1">
                        <label for="new-order-date" class="block text-sm font-semibold text-gray-700 mb-1">×ª××¨×™×š ×”×–×× ×” <span class="text-red-500">*</span></label>
                        <input type="date" id="new-order-date" name="×ª××¨×™×š ×”×–×× ×”" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-violet-300 focus:border-violet-500 transition-all" required>
                    </div>
                    <div class="col-span-1">
                        <label for="new-order-docid" class="block text-sm font-semibold text-gray-700 mb-1">×ª×¢×•×“×” <span class="text-red-500">*</span></label>
                        <input type="text" id="new-order-docid" name="×ª×¢×•×“×”" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-violet-300 focus:border-violet-500 transition-all" required>
                        <p id="docid-error" class="text-red-500 text-sm mt-1 hidden">××¡×¤×¨ ×ª×¢×•×“×” ×–×” ×›×‘×¨ ×§×™×™×.</p>
                    </div>
                    <div class="col-span-1">
                        <label for="new-order-agent" class="block text-sm font-semibold text-gray-700 mb-1">×©× ×¡×•×›×Ÿ</label>
                        <input type="text" id="new-order-agent" name="×©× ×¡×•×›×Ÿ" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-violet-300 focus:border-violet-500 transition-all">
                    </div>
                    <div class="col-span-1">
                        <label for="new-order-customer-name" class="block text-sm font-semibold text-gray-700 mb-1">×©× ×œ×§×•×— <span class="text-red-500">*</span></label>
                        <input type="text" id="new-order-customer-name" name="×©× ×œ×§×•×—" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-violet-300 focus:border-violet-500 transition-all" required>
                    </div>
                    <div class="col-span-2">
                        <label for="new-order-address" class="block text-sm font-semibold text-gray-700 mb-1">×›×ª×•×‘×ª</label>
                        <input type="text" id="new-order-address" name="×›×ª×•×‘×ª" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-violet-300 focus:border-violet-500 transition-all">
                    </div>
                    <div class="col-span-1">
                        <label for="new-order-action-type" class="block text-sm font-semibold text-gray-700 mb-1">×¡×•×’ ×¤×¢×•×œ×” <span class="text-red-500">*</span></label>
                        <select id="new-order-action-type" name="×¡×•×’ ×¤×¢×•×œ×”" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-violet-300 focus:border-violet-500 transition-all" required>
                            <option value="">×‘×—×¨ ×¤×¢×•×œ×”</option>
                            <option value="×”×¦×‘×”">×”×¦×‘×”</option>
                            <option value="×”×—×œ×¤×”">×”×—×œ×¤×”</option>
                            <option value="×”×•×¦××”">×”×•×¦××”</option>
                            <option value="×”×–×–×”">×”×–×–×”</option>
                            <option value="×¤×™× ×•×™ ×‘××§×•×">×¤×™× ×•×™ ×‘××§×•×</option>
                            <option value="×’×™×©×” ×œ×œ× ×¤×¢×•×œ×”">×’×™×©×” ×œ×œ× ×¤×¢×•×œ×”</option>
                        </select>
                    </div>
                    <div class="col-span-1">
                        <label for="new-order-status" class="block text-sm font-semibold text-gray-700 mb-1">×¡×˜×˜×•×¡ <span class="text-red-500">*</span></label>
                        <select id="new-order-status" name="×¡×˜×˜×•×¡" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-violet-300 focus:border-violet-500 transition-all" required>
                            <option value="×¤×ª×•×—">×¤×ª×•×—</option>
                            <option value="×—×•×¨×’">×—×•×¨×’</option>
                            <option value="×¡×’×•×¨">×¡×’×•×¨</option>
                        </select>
                    </div>
                    <div class="col-span-1">
                        <label for="new-order-container-dropped" class="block text-sm font-semibold text-gray-700 mb-1">××¡×¤×¨ ××›×•×œ×” ×™×¨×“×”</label>
                        <input type="text" id="new-order-container-dropped" name="××¡×¤×¨ ××›×•×œ×” ×™×¨×“×”" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-violet-300 focus:border-violet-500 transition-all">
                        <p id="container-dropped-error" class="text-red-500 text-sm mt-1 hidden"></p>
                    </div>
                    <div class="col-span-1">
                        <label for="new-order-container-lifted" class="block text-sm font-semibold text-gray-700 mb-1">××¡×¤×¨ ××›×•×œ×” ×¢×œ×ª×”</label>
                        <input type="text" id="new-order-container-lifted" name="××¡×¤×¨ ××›×•×œ×” ×¢×œ×ª×”" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-violet-300 focus:border-violet-500 transition-all">
                        <p id="container-lifted-error" class="text-red-500 text-sm mt-1 hidden"></p>
                    </div>
                    <div class="col-span-1">
                        <label for="new-order-expected-end-date" class="block text-sm font-semibold text-gray-700 mb-1">×ª××¨×™×š ×¡×™×•× ×¦×¤×•×™</label>
                        <input type="date" id="new-order-expected-end-date" name="×ª××¨×™×š ×¡×™×•× ×¦×¤×•×™" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-violet-300 focus:border-violet-500 transition-all">
                    </div>
                    <div class="col-span-1">
                        <label for="new-order-phone" class="block text-sm font-semibold text-gray-700 mb-1">×˜×œ×¤×•×Ÿ ×œ×§×•×—</label>
                        <input type="tel" id="new-order-phone" name="×˜×œ×¤×•×Ÿ ×œ×§×•×—" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-violet-300 focus:border-violet-500 transition-all">
                    </div>
                    <div class="col-span-2">
                        <label for="new-order-notes" class="block text-sm font-semibold text-gray-700 mb-1">×”×¢×¨×•×ª</label>
                        <textarea id="new-order-notes" name="×”×¢×¨×•×ª" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-violet-300 focus:border-violet-500 transition-all" rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="p-4 bg-gray-50 text-left flex justify-end gap-2 rounded-b-lg">
                <button onclick="closeNewOrderModal()" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors">×‘×™×˜×•×œ</button>
                <button onclick="submitNewOrder()" class="px-4 py-2 bg-green-500 text-white rounded-lg shadow-md hover:bg-green-600 transition-colors">×”×•×¡×£ ×”×–×× ×”</button>
            </div>
        </div>
    </div>

    <!-- Edit Order Modal (New) -->
    <div id="edit-order-modal" class="fixed inset-0 modal-overlay hidden items-center justify-center">
        <div class="modal-content bg-white rounded-lg shadow-2xl w-11/12 max-w-2xl overflow-y-auto">
            <div class="p-6 border-b flex justify-between items-center bg-gray-50 rounded-t-lg">
                <h2 class="text-2xl font-bold">×¢×¨×™×›×ª ×”×–×× ×”</h2>
                <button onclick="closeEditOrderModal()" class="text-gray-500 hover:text-gray-700 text-3xl font-light leading-none">&times;</button>
            </div>
            <div class="p-6">
                <form id="edit-order-form" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <input type="hidden" id="edit-order-original-docid">
                    <div class="col-span-1">
                        <label for="edit-order-date" class="block text-sm font-semibold text-gray-700 mb-1">×ª××¨×™×š ×”×–×× ×” <span class="text-red-500">*</span></label>
                        <input type="date" id="edit-order-date" name="×ª××¨×™×š ×”×–×× ×”" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-violet-300 focus:border-violet-500 transition-all" required>
                    </div>
                    <div class="col-span-1">
                        <label for="edit-order-docid" class="block text-sm font-semibold text-gray-700 mb-1">×ª×¢×•×“×” <span class="text-red-500">*</span></label>
                        <input type="text" id="edit-order-docid" name="×ª×¢×•×“×”" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-violet-300 focus:border-violet-500 transition-all" required>
                        <p id="edit-docid-error" class="text-red-500 text-sm mt-1 hidden">××¡×¤×¨ ×ª×¢×•×“×” ×–×” ×›×‘×¨ ×§×™×™×.</p>
                    </div>
                    <div class="col-span-1">
                        <label for="edit-order-agent" class="block text-sm font-semibold text-gray-700 mb-1">×©× ×¡×•×›×Ÿ</label>
                        <input type="text" id="edit-order-agent" name="×©× ×¡×•×›×Ÿ" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-violet-300 focus:border-violet-500 transition-all">
                    </div>
                    <div class="col-span-1">
                        <label for="edit-order-customer-name" class="block text-sm font-semibold text-gray-700 mb-1">×©× ×œ×§×•×— <span class="text-red-500">*</span></label>
                        <input type="text" id="edit-order-customer-name" name="×©× ×œ×§×•×—" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-violet-300 focus:border-violet-500 transition-all" required>
                    </div>
                    <div class="col-span-2">
                        <label for="edit-order-address" class="block text-sm font-semibold text-gray-700 mb-1">×›×ª×•×‘×ª</label>
                        <input type="text" id="edit-order-address" name="×›×ª×•×‘×ª" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-violet-300 focus:border-violet-500 transition-all">
                    </div>
                    <div class="col-span-1">
                        <label for="edit-order-action-type" class="block text-sm font-semibold text-gray-700 mb-1">×¡×•×’ ×¤×¢×•×œ×” <span class="text-red-500">*</span></label>
                        <select id="edit-order-action-type" name="×¡×•×’ ×¤×¢×•×œ×”" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-violet-300 focus:border-violet-500 transition-all" required>
                            <option value="">×‘×—×¨ ×¤×¢×•×œ×”</option>
                            <option value="×”×¦×‘×”">×”×¦×‘×”</option>
                            <option value="×”×—×œ×¤×”">×”×—×œ×¤×”</option>
                            <option value="×”×•×¦××”">×”×•×¦××”</option>
                            <option value="×”×–×–×”">×”×–×–×”</option>
                            <option value="×¤×™× ×•×™ ×‘××§×•×">×¤×™× ×•×™ ×‘××§×•×</option>
                            <option value="×’×™×©×” ×œ×œ× ×¤×¢×•×œ×”">×’×™×©×” ×œ×œ× ×¤×¢×•×œ×”</option>
                        </select>
                    </div>
                    <div class="col-span-1">
                        <label for="edit-order-status" class="block text-sm font-semibold text-gray-700 mb-1">×¡×˜×˜×•×¡ <span class="text-red-500">*</span></label>
                        <select id="edit-order-status" name="×¡×˜×˜×•×¡" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-violet-300 focus:border-violet-500 transition-all" required>
                            <option value="×¤×ª×•×—">×¤×ª×•×—</option>
                            <option value="×—×•×¨×’">×—×•×¨×’</option>
                            <option value="×¡×’×•×¨">×¡×’×•×¨</option>
                        </select>
                    </div>
                    <div class="col-span-1">
                        <label for="edit-order-container-dropped" class="block text-sm font-semibold text-gray-700 mb-1">××¡×¤×¨ ××›×•×œ×” ×™×¨×“×”</label>
                        <input type="text" id="edit-order-container-dropped" name="××¡×¤×¨ ××›×•×œ×” ×™×¨×“×”" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-violet-300 focus:border-violet-500 transition-all">
                        <p id="edit-container-dropped-error" class="text-red-500 text-sm mt-1 hidden"></p>
                    </div>
                    <div class="col-span-1">
                        <label for="edit-order-container-lifted" class="block text-sm font-semibold text-gray-700 mb-1">××¡×¤×¨ ××›×•×œ×” ×¢×œ×ª×”</label>
                        <input type="text" id="edit-order-container-lifted" name="××¡×¤×¨ ××›×•×œ×” ×¢×œ×ª×”" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-violet-300 focus:border-violet-500 transition-all">
                        <p id="edit-container-lifted-error" class="text-red-500 text-sm mt-1 hidden"></p>
                    </div>
                    <div class="col-span-1">
                        <label for="edit-order-expected-end-date" class="block text-sm font-semibold text-gray-700 mb-1">×ª××¨×™×š ×¡×™×•× ×¦×¤×•×™</label>
                        <input type="date" id="edit-order-expected-end-date" name="×ª××¨×™×š ×¡×™×•× ×¦×¤×•×™" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-violet-300 focus:border-violet-500 transition-all">
                    </div>
                    <div class="col-span-1">
                        <label for="edit-order-phone" class="block text-sm font-semibold text-gray-700 mb-1">×˜×œ×¤×•×Ÿ ×œ×§×•×—</label>
                        <input type="tel" id="edit-order-phone" name="×˜×œ×¤×•×Ÿ ×œ×§×•×—" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-violet-300 focus:border-violet-500 transition-all">
                    </div>
                    <div class="col-span-2">
                        <label for="edit-order-notes" class="block text-sm font-semibold text-gray-700 mb-1">×”×¢×¨×•×ª</label>
                        <textarea id="edit-order-notes" name="×”×¢×¨×•×ª" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-violet-300 focus:border-violet-500 transition-all" rows="3"></textarea>
                    </div>
                    <div class="col-span-2">
                        <label for="edit-order-closure-notes" class="block text-sm font-semibold text-gray-700 mb-1">×”×¢×¨×•×ª ×¡×™×•×</label>
                        <textarea id="edit-order-closure-notes" name="×”×¢×¨×•×ª ×¡×™×•×" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-violet-300 focus:border-violet-500 transition-all" rows="3"></textarea>
                    </div>
                     <div class="col-span-1">
                        <label for="edit-order-closure-date" class="block text-sm font-semibold text-gray-700 mb-1">×ª××¨×™×š ×¡×’×™×¨×”</label>
                        <input type="date" id="edit-order-closure-date" name="×ª××¨×™×š ×¡×’×™×¨×”" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-violet-300 focus:border-violet-500 transition-all">
                    </div>
                </form>
            </div>
            <div class="p-4 bg-gray-50 text-left flex justify-end gap-2 rounded-b-lg">
                <button onclick="closeEditOrderModal()" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors">×‘×™×˜×•×œ</button>
                <button onclick="submitEditOrder()" class="px-4 py-2 bg-blue-600 text-white rounded-lg shadow-md hover:bg-blue-700 transition-colors">×©××•×¨ ×©×™× ×•×™×™×</button>
            </div>
        </div>
    </div>


    <!-- JavaScript code -->
    <script>
        // Global state variables
        let allOperations = []; // Stores all operations, with dates parsed as Date objects
        let historicalOperations = []; // Static historical data (from rawDataString)
        let charts = {}; // Stores Chart.js instances
        let isLoadingData = false; // Flag to indicate data loading state
        let typingInterval; // Interval for typing effect
        let currentMessageFullText = ''; // Full text for typing effect
        let typingIndex = 0; // Current index for typing effect
        let containerLedger = {}; // Stores detailed history and current status for each container
        let customerNotes = {}; // Stores latest notes for customers for the KPI cards

        // Utility functions
        /**
         * Parses a date string into a Date object. Handles 'YYYY-MM-DD' and 'DD/MM/YYYY'.
         * @param {string} dateStr - The date string to parse.
         * @returns {Date|null} A Date object if successful, otherwise null.
         */
        const formatDate = (dateStr) => {
            if (!dateStr) return null;
            // Handle YYYY-MM-DD format
            if (dateStr.includes('-') && dateStr.split('-').length === 3) {
                const date = new Date(dateStr);
                return isNaN(date.getTime()) ? null : date;
            }
            // Handle DD/MM/YYYY format
            if (dateStr.includes('/') && dateStr.split('/').length === 3) {
                const parts = dateStr.split('/');
                const date = new Date(`${parts[2]}-${parts[1]}-${parts[0]}`); // Assumes DD/MM/YYYY
                return isNaN(date.getTime()) ? null : date;
            }
            return null;
        };

        /**
         * Formats a Date object into a 'YYYY-MM-DD' string.
         * @param {Date|null} dateObj - The Date object to format.
         * @returns {string} The formatted date string, or empty string if invalid.
         */
        const formatISODate = (dateObj) => {
            if (!dateObj || isNaN(dateObj.getTime())) return '';
            return dateObj.toISOString().split('T')[0];
        };

        /**
         * Calculates the number of days between a given date and today.
         * @param {Date|null} date - The reference Date object.
         * @returns {number} The number of full days passed, or 0 if date is invalid.
         */
        const daysSince = (date) => {
            if (!date || isNaN(date.getTime())) return 0;
            const today = new Date();
            today.setHours(0, 0, 0, 0); // Normalize today to start of day
            const opDate = new Date(date);
            opDate.setHours(0, 0, 0, 0); // Normalize opDate to start of day

            const diff = today.getTime() - opDate.getTime();
            return Math.floor(diff / (1000 * 60 * 60 * 24));
        };

         /**
         * Calculates the number of days between two dates.
         * @param {Date|null} startDate - The start Date object.
         * @param {Date|null} endDate - The end Date object.
         * @returns {number} The number of full days between the dates, or 0 if dates are invalid.
         */
        const daysBetween = (startDate, endDate) => {
            if (!startDate || isNaN(startDate.getTime()) || !endDate || isNaN(endDate.getTime())) return 0;
            const sDate = new Date(startDate);
            sDate.setHours(0, 0, 0, 0);
            const eDate = new Date(endDate);
            eDate.setHours(0, 0, 0, 0);

            const diff = eDate.getTime() - sDate.getTime();
            return Math.floor(diff / (1000 * 60 * 60 * 24));
        };

        /**
         * Debounces a function call.
         * @param {Function} func - The function to debounce.
         * @param {number} delay - The delay in milliseconds.
         * @returns {Function} The debounced function.
         */
        const debounce = (func, delay) => {
            let timeout;
            return function(...args) {
                const context = this;
                clearTimeout(timeout);
                timeout = setTimeout(() => func.apply(context, args), delay);
            };
        };

        // Global functions for HTML onclick attributes
        /**
         * Shows the specified page (tab) and updates navigation button active state.
         * @param {string} pageId - The ID of the page to show ('dashboard', 'inventory', 'treatment').
         */
        const showPage = (pageId) => {
            ['dashboard', 'inventory', 'treatment'].forEach(id => {
                document.getElementById(`page-${id}`).classList.add('hidden');
                document.getElementById(`nav-${id}`).classList.remove('active');
            });
            document.getElementById(`page-${pageId}`).classList.remove('hidden');
            document.getElementById(`nav-${pageId}`).classList.add('active');

            // Hide the 'no overdue' message if not on the treatment page
            if (pageId !== 'treatment') {
                document.getElementById('no-overdue-message').classList.add('hidden');
            }
        };

        /**
         * Attempts to extract an Israeli city name from an address string.
         * @param {string} address - The address string.
         * @returns {string|null} The city name if found, otherwise null.
         */
        const getCityFromAddress = (address) => {
            if (!address) return null;
            const israeliCities = [
                "×ª×œ ××‘×™×‘", "×™×¨×•×©×œ×™×", "×—×™×¤×”", "×¨××©×•×Ÿ ×œ×¦×™×•×Ÿ", "×¤×ª×— ×ª×§×•×•×”", "××©×“×•×“", "×‘××¨ ×©×‘×¢",
                "× ×ª× ×™×”", "×‘× ×™ ×‘×¨×§", "×—×•×œ×•×Ÿ", "×¨××ª ×’×Ÿ", "×¨×—×•×‘×•×ª", "××©×§×œ×•×Ÿ", "×‘×ª ×™×", "×”×¨×¦×œ×™×”",
                "×›×¤×¨ ×¡×‘×", "×—×“×¨×”", "×‘×™×ª ×©××©", "××•×“×™×¢×™×Ÿ-××›×‘×™×-×¨×¢×•×ª", "×œ×•×“", "×¨××œ×”", "×¨×¢× × ×”",
                "× ×”×¨×™×”", "×§×¨×™×™×ª ×’×ª", "××™×œ×ª", "×¢×›×•", "×¦×¤×ª", "×˜×‘×¨×™×”", "× ×¦×¨×ª", "××•× ××œ-×¤××—×",
                "×‘× ×™ ×¦×™×•×Ÿ", "××‘×Ÿ ×™×”×•×“×”", "××•×¨ ×™×”×•×“×”", "××•×¨ ×¢×§×™×‘×", "××¨×™××œ", "××©×§×œ×•×Ÿ", "×‘××§×” ××œ-×’×¨×‘×™×™×”",
                "×’×‘×¢×ª×™×™×", "×“×™××•× ×”", "×”×•×“ ×”×©×¨×•×Ÿ", "×–×›×¨×•×Ÿ ×™×¢×§×‘", "×™×‘× ×”", "×™×”×•×“-××•× ×•×¡×•×Ÿ", "×™×•×§× ×¢× ×¢×™×œ×™×ª",
                "×›×•×›×‘ ×™××™×¨", "×›×¤×¨ ×™×•× ×”", "×›×¤×¨ ×§××¡×", "×›×¨××™××œ", "××’×“×œ ×”×¢××§", "××›×‘×™×", "××¢×œ×” ××“×•××™×",
                "××¦×¤×” ×¨××•×Ÿ", "× ×”×¨×™×”", "× ×¡ ×¦×™×•× ×”", "× ×©×¨", "×¢×¤×•×œ×”", "×¢×¨×“", "×¤×¨×“×¡ ×—× ×”-×›×¨×›×•×¨",
                "×§×¨×™×™×ª ××•× ×•", "×§×¨×™×™×ª ×‘×™××œ×™×§", "×§×¨×™×™×ª ×™×", "×§×¨×™×™×ª ××•×¦×§×™×Ÿ", "×§×¨×™×™×ª ×©××•× ×”",
                "×©×•×”×", "×©×“×¨×•×ª", "×¨××ª ×”×©×¨×•×Ÿ"
            ].sort((a,b) => b.length - a.length); // Sort by length descending for better matching

            for (const city of israeliCities) {
                if (address.includes(city)) {
                    return city;
                }
            }
            return null;
        };

        // Predefined WhatsApp messages and city guidelines
        const whatsappMessages = [
            { id: 'new_customer_welcome', text: '×©×œ×•× **[×©× ×œ×§×•×—]**,\n×ª×•×“×” ×©×‘×—×¨×ª ×œ×”×ª×—×™×œ ×©×›×™×¨×•×ª ××›×•×œ×” ××¦×œ× ×•! ğŸ‘‹ ×œ×›×œ ×¤× ×™×”, ×‘×§×©×ª ×”×—×œ×¤×” ××• ×”×•×¦××” ×©×œ ×”××›×•×œ×”, ××ª×” ××•×–××Ÿ ×œ×™×¦×•×¨ ×§×©×¨.\n\nğŸ“ ××¡×¤×¨ ×•×•×˜×¡××¤ ×œ×”×–×× ×•×ª: **[××¡×¤×¨ ×˜×œ×¤×•×Ÿ ×—×‘×¨×”]**\nâ˜ï¸ ×˜×œ×¤×•×Ÿ ××—×œ×§×ª ×”×–×× ×•×ª: **[×˜×œ×¤×•×Ÿ ×—×‘×¨×”]**', category: '×›×œ×œ×™', placeholders: ['×©× ×œ×§×•×—', '××¡×¤×¨ ×˜×œ×¤×•×Ÿ ×—×‘×¨×”', '×˜×œ×¤×•×Ÿ ×—×‘×¨×”'], emoji: 'ğŸ‘‹' },
            { id: 'approaching_due_7_days', text: '×©×œ×•× **[×©× ×œ×§×•×—]**,\n\n×‘×¨×¦×•× × ×• ×œ×”×–×›×™×¨ ×œ×š ×›×™ ×ª×§×•×¤×ª ×©×›×™×¨×•×ª ×”××›×•×œ×” ([**××¡×¤×¨ ××›×•×œ×”**]) ××¡×ª×™×™××ª ×‘×¢×•×“ **7 ×™××™×** ğŸ—“ï¸. ×–×” ×”×–××Ÿ ×œ× ×§×•×˜ ×¤×¢×•×œ×”!\n\n×”×× ×ª×¨×¦×” ×œ×”××¨×™×š ××ª ×ª×§×•×¤×ª ×”×©×›×™×¨×•×ª, ×œ×”×—×œ×™×£ ××ª ×”××›×•×œ×”, ××• ×œ×”×–××™×Ÿ ××™×¡×•×£? â™»ï¸', category: '×ª×–×›×•×¨×•×ª', placeholders: ['×©× ×œ×§×•×—', '××¡×¤×¨ ××›×•×œ×”'], emoji: 'â°' },
            { id: 'approaching_due_3_days', text: '×©×œ×•× **[×©× ×œ×§×•×—]**,\n\n×ª×§×•×¤×ª ×©×›×™×¨×•×ª ×”××›×•×œ×” ([**××¡×¤×¨ ××›×•×œ×”**]) ××¡×ª×™×™××ª ×××© ×‘×§×¨×•×‘, ×‘×¢×•×“ **3 ×™××™×** âš ï¸. ×× × ×˜×¤×œ ×‘× ×•×©× ×›×“×™ ×œ×× ×•×¢ ×—×¨×™×’×•×ª.\n\n×× ×• ×œ×¨×©×•×ª×š ×œ×›×œ ×¢×–×¨×”! ğŸ™', category: '×ª×–×›×•×¨×•×ª', placeholders: ['×©× ×œ×§×•×—', '××¡×¤×¨ ××›×•×œ×”'], emoji: 'â³' },
            { id: 'overdue_7_days', text: '×©×œ×•× **[×©× ×œ×§×•×—]**,\n\n×‘×¨×¦×•× × ×• ×œ×”×•×“×™×¢ ×œ×š ×¢×œ ×—×¨×™×’×” ×‘×™××™ ×©×›×™×¨×•×ª ×©×œ ×”××›×•×œ×” ([**××¡×¤×¨ ××›×•×œ×”**]) ×‘-**[×™××™× ×©×¢×‘×¨×•] ×™××™×** ğŸš¨. × × ×œ×™×¦×•×¨ ×§×©×¨ ×¢× ××—×œ×§×ª ×”×–×× ×•×ª **[×˜×œ×¤×•×Ÿ ×—×‘×¨×”]** ××• ×œ×”×©×™×‘ ×œ×”×•×“×¢×” ×–×• ××” ×ª×¨×¦×” ×©× ×‘×¦×¢ (×”×—×œ×¤×”/×”×•×¦××”).', category: '×—×¨×™×’×•×ª', placeholders: ['×©× ×œ×§×•×—', '××¡×¤×¨ ××›×•×œ×”', '×™××™× ×©×¢×‘×¨×•', '×˜×œ×¤×•×Ÿ ×—×‘×¨×”'], emoji: 'â—ï¸' },
            { id: 'overdue_30_days', text: '**×”×ª×¨××” ×—××•×¨×”, [×©× ×œ×§×•×—]:**\n\n×”××›×•×œ×” ([**××¡×¤×¨ ××›×•×œ×”**]) ×©×‘×©×™××•×©×š ×—×•×¨×’×ª ×‘-**[×™××™× ×©×¢×‘×¨×•] ×™××™×**! ×™×© ×œ×˜×¤×œ ×‘× ×•×©× ×‘×“×—×™×¤×•×ª ×›×“×™ ×œ×× ×•×¢ ×—×™×•×‘×™× × ×•×¡×¤×™× ×•×¡×™×‘×•×›×™× ××©×¤×˜×™×™×. âš–ï¸\n\n**×¦×•×¨ ×§×©×¨ ××™×™×“×™×ª: [×˜×œ×¤×•×Ÿ ×—×‘×¨×”].**', category: '×—×¨×™×’×•×ª', placeholders: ['×©× ×œ×§×•×—', '××¡×¤×¨ ××›×•×œ×”', '×™××™× ×©×¢×‘×¨×•', '×˜×œ×¤×•×Ÿ ×—×‘×¨×”'], emoji: 'ğŸ”´' },
            { id: 'overdue_long', text: '**×œ×›×‘×•×“: [×©× ×œ×§×•×—]**\n\n**×”× ×“×•×Ÿ: ×—×•×‘ ×‘×’×™×Ÿ ×©×›×™×¨×•×ª ××›×•×œ×” ×—×•×¨×’×ª**\n\n×× ×• ×¤×•× ×™× ××œ×™×š ×‘×”×ª×™×™×—×¡ ×œ×—×©×‘×•× ×š, ×”× ××¦× ×‘×—×¨×™×’×” ××©××¢×•×ª×™×ª ×©×œ [**×™××™× ×©×¢×‘×¨×•**] ×™××™× ×¢×‘×•×¨ ××›×•×œ×” ([**××¡×¤×¨ ××›×•×œ×”**]).\n\n×‘×”×™×¢×“×¨ ×”×¡×“×¨×” ××™×™×“×™×ª, ×× ×• × ××œ×¦×™× ×œ× ×§×•×˜ ×‘×¦×¢×“×™× ××©×¤×˜×™×™× ×œ×’×‘×™×™×”. ×× ×• ×§×•×¨××™× ×œ×š ×œ×™×¦×•×¨ ×§×©×¨ ×“×—×•×£ ×œ×”×¡×“×¨: **[×˜×œ×¤×•×Ÿ ×—×‘×¨×”]**.', category: '××©×¤×˜×™', placeholders: ['×©× ×œ×§×•×—', '××¡×¤×¨ ××›×•×œ×”', '×™××™× ×©×¢×‘×¨×•', '×˜×œ×¤×•×Ÿ ×—×‘×¨×”'], emoji: '' },
            { id: 'general_inquiry', text: '×©×œ×•× **[×©× ×œ×§×•×—]**,\n\n××™×š ×× ×—× ×• ×™×›×•×œ×™× ×œ×¢×–×•×¨ ×œ×š ×”×™×•×? ğŸ¤” ×× ×™×© ×œ×š ×©××œ×•×ª, ×‘×§×©×•×ª ××• ×ª×–×›×•×¨×•×ª, ××œ ×ª×”×¡×¡ ×œ×¤× ×•×ª ××œ×™× ×•. ×× ×—× ×• ×›××Ÿ ×‘×©×‘×™×œ×š! âœ¨', category: '×›×œ×œ×™', placeholders: ['×©× ×œ×§×•×—'], emoji: 'ğŸ’¬' },
            { id: 'payment_reminder', text: '×©×œ×•× **[×©× ×œ×§×•×—]**,\n\n×ª×–×›×•×¨×ª ×™×“×™×“×•×ª×™×ª ×œ×’×‘×™ ×ª×©×œ×•× ×—×©×‘×•× ×™×ª ××¡×¤×¨ **[×ª×¢×•×“×”]** ğŸ’°. ×× ×• ××•×“×™× ×œ×š ×¢×œ ×ª×©×•××ª ×”×œ×‘ ×”××”×™×¨×” ×•×¢×œ ×”××©×š ×©×™×ª×•×£ ×”×¤×¢×•×œ×”.', category: '×ª×–×›×•×¨×•×ª', placeholders: ['×©× ×œ×§×•×—', '×ª×¢×•×“×”'], emoji: 'ğŸ’²' },
            { id: 'service_feedback', text: '×©×œ×•× **[×©× ×œ×§×•×—]**,\n\n×× ×• ××§×•×•×™× ×©×©×™×¨×•×ª×™× ×• ×¢×•× ×™× ×¢×œ ×¦×™×¤×™×•×ª×™×š. × ×©××— ×œ×§×‘×œ ××©×•×‘ ×¢×œ ×”×—×•×•×™×” ×©×œ×š ×¢× ××›×•×œ×” ××¡×¤×¨ **[××¡×¤×¨ ××›×•×œ×”]** ×›×“×™ ×©× ×•×›×œ ×œ×”×©×ª×¤×¨ ×•×œ×”×¢× ×™×§ ×œ×š ×©×™×¨×•×ª ×˜×•×‘ ×™×•×ª×¨. â­', category: '××©×•×‘', placeholders: ['×©× ×œ×§×•×—', '××¡×¤×¨ ××›×•×œ×”'], emoji: 'ğŸ“' },
            { id: 'holiday_greetings', text: '×—×’ ×©××—, **[×©× ×œ×§×•×—]**! ğŸ‰\n\n×¦×•×•×ª [×©× ×”×—×‘×¨×”] ×××—×œ ×œ×š ×•×œ××©×¤×—×ª×š ×—×’ ×©××—, ××œ× ×©×œ×•×•×”, ×‘×¨×™××•×ª ×•×”××•×Ÿ ×©××—×”! ğŸ¥³', category: '×¢×•× ×ª×™', placeholders: ['×©× ×œ×§×•×—', '×©× ×”×—×‘×¨×”'], emoji: 'ğŸ' },
            { id: 'special_offer', text: '×©×œ×•× **[×©× ×œ×§×•×—]**,\n\n×™×© ×œ× ×• ×—×“×©×•×ª ××¨×’×©×•×ª! ğŸ ××‘×¦×¢ ××™×•×—×“ ×œ××›×•×œ×•×ª ×—×“×©×•×ª/× ×•×¡×¤×•×ª ×¢×‘×•×¨×š. ××œ ×ª×—××™×¥! ×œ×¤×¨×˜×™× × ×•×¡×¤×™×, ×”×©×‘ ×œ×”×•×“×¢×” ×–×• ××• ×”×ª×§×©×¨: **[×˜×œ×¤×•×Ÿ ×—×‘×¨×”]**.', category: '×©×™×•×•×§', placeholders: ['×©× ×œ×§×•×—', '×˜×œ×¤×•×Ÿ ×—×‘×¨×”'], emoji: 'âœ¨' },
            { id: 'follow_up_issue', text: '×©×œ×•× **[×©× ×œ×§×•×—]**,\n\n×× ×—× ×• ×—×•×–×¨×™× ××œ×™×š ×œ×’×‘×™ ×”× ×•×©× ×©×“×™×•×•×—×ª ×¢×œ×™×• ×‘×ª×¢×•×“×” **[×ª×¢×•×“×”]** ğŸ› ï¸. ×”×× ×”×‘×¢×™×” × ×¤×ª×¨×” ×œ×©×‘×™×¢×•×ª ×¨×¦×•× ×š? ×× ×œ×, ×× × ×”×•×“×¢ ×œ× ×• ×›×“×™ ×©× ×•×›×œ ×œ×”××©×™×š ×œ×˜×¤×œ.', category: '×ª××™×›×”', placeholders: ['×©× ×œ×§×•×—', '×ª×¢×•×“×”'], emoji: 'âœ…' },
            { id: 'document_reminder', text: '×©×œ×•× **[×©× ×œ×§×•×—]**,\n\n×ª×–×›×•×¨×ª ×œ×©×œ×™×—×ª ×”××¡××›×™× ×”×—×¡×¨×™× ×¢×‘×•×¨ ×”×–×× ×” **[×ª×¢×•×“×”]** ğŸ“„. ×× × ×©×œ×— ××•×ª× ×‘×”×§×“× ×›×“×™ ×©× ×•×›×œ ×œ×”×©×œ×™× ××ª ×”×˜×™×¤×•×œ ×‘×”×–×× ×”.\n\n×ª×•×“×” ×¢×œ ×©×™×ª×•×£ ×”×¤×¢×•×œ×”!', category: '×ª×–×›×•×¨×•×ª', placeholders: ['×©× ×œ×§×•×—', '×ª×¢×•×“×”'], emoji: 'ğŸ“Œ' },
            { id: 'service_confirmation', text: '×©×œ×•× **[×©× ×œ×§×•×—]**,\n\n×”×©×™×¨×•×ª ×©×”×•×–××Ÿ (×ª×¢×•×“×” **[×ª×¢×•×“×”]**) ××•×©×¨ ×•×™×ª×‘×¦×¢ ×‘-**[×ª××¨×™×š ×¡×™×•× ×¦×¤×•×™]** âœ…. ×ª×•×“×” ×©×‘×—×¨×ª ×‘× ×• ×•×©×™×”×™×” ×™×•× × ×¤×œ×!', category: '××™×©×•×¨', placeholders: ['×©× ×œ×§×•×—', '×ª×¢×•×“×”', '×ª××¨×™×š ×¡×™×•× ×¦×¤×•×™'], emoji: 'ğŸ‘' },
            { id: 'service_delay', text: '×©×œ×•× **[×©× ×œ×§×•×—]**,\n\n×¢×§×‘ × ×¡×™×‘×•×ª ×‘×œ×ª×™ ×¦×¤×•×™×•×ª, ×™×™×ª×›×Ÿ ×©×™×”×™×” ×¢×™×›×•×‘ ×§×œ ×‘×˜×™×¤×•×œ ×‘×”×–×× ×” **[×ª×¢×•×“×”]** â±ï¸. ×× ×• ××ª× ×¦×œ×™× ×¢×œ ××™ ×”× ×•×—×•×ª ×•× ×¤×¢×œ ×œ×¤×ª×•×¨ ×–××ª ×‘××”×™×¨×•×ª ×”××¤×©×¨×™×ª.\n\n× ×•×“×™×¢ ×œ×š ×¢×œ ×›×œ ×¢×“×›×•×Ÿ! ğŸ”œ', category: '××™×“×¢', placeholders: ['×©× ×œ×§×•×—', '×ª×¢×•×“×”'], emoji: 'ğŸš§' },
            { id: 'location_update_request', text: '×©×œ×•× **[×©× ×œ×§×•×—]**,\n\n×›×“×™ ×©× ×•×›×œ ×œ×ª×× ××ª ×”×©×™×¨×•×ª ×‘×¦×•×¨×” ×”×˜×•×‘×” ×‘×™×•×ª×¨, ×× × ×•×•×“× ×©××™×§×•× ×”××›×•×œ×” ([**××¡×¤×¨ ××›×•×œ×”**]) ××¢×•×“×›×Ÿ ×•××“×•×™×§ ğŸ“. ×–×” ×—×©×•×‘ ×œ×”×’×¢×” ×™×¢×™×œ×”!', category: '×ª×–×›×•×¨×•×ª', placeholders: ['×©× ×œ×§×•×—', '××¡×¤×¨ ××›×•×œ×”'], emoji: 'ğŸ—ºï¸' },
            { id: 'happy_birthday', text: '×™×•× ×”×•×œ×“×ª ×©××—, **[×©× ×œ×§×•×—]**! ğŸ‰ğŸ‚\n\n×¦×•×•×ª [×©× ×”×—×‘×¨×”] ×××—×œ ×œ×š ×™×•× ××œ× ×‘×©××—×”, ×‘×¨×™××•×ª, ×”×’×©××” ×•×”×¨×‘×” ×¨×’×¢×™× ××ª×•×§×™×! ğŸ¥³', category: '×¢×•× ×ª×™', placeholders: ['×©× ×œ×§×•×—', '×©× ×”×—×‘×¨×”'], emoji: 'ğŸˆ' },
            { id: 'review_invitation', text: '×©×œ×•× **[×©× ×œ×§×•×—]**,\n\n× ×”× ×™×ª ××”×©×™×¨×•×ª ×©×œ× ×•? âœ¨ × ×©××— ×× ×ª×•×›×œ ×œ×”×§×“×™×© ×¨×’×¢ ×•×œ×›×ª×•×‘ ×œ× ×• ×‘×™×§×•×¨×ª ×§×¦×¨×” ×›××Ÿ: [**×œ×™× ×§ ×œ×‘×™×§×•×¨×ª**]. ×ª×•×“×” ××¨××© ×¢×œ ×¢×–×¨×ª×š ×œ×”×©×ª×¤×¨! ğŸ™', category: '××©×•×‘', placeholders: ['×©× ×œ×§×•×—', '×œ×™× ×§ ×œ×‘×™×§×•×¨×ª'], emoji: 'ğŸŒŸ' },
            { id: 'tech_support_contact', text: '×©×œ×•× **[×©× ×œ×§×•×—]**,\n\n×œ×›×œ ×‘×¢×™×” ×˜×›× ×™×ª ××• ×ª×¤×¢×•×œ×™×ª ×¢× ×”××›×•×œ×” ([**××¡×¤×¨ ××›×•×œ×”**]), ××—×œ×§×ª ×”×ª××™×›×” ×©×œ× ×• ×–××™× ×” ×¢×‘×•×¨×š ğŸ§‘â€ğŸ”§.\n\n**×¦×•×¨ ×§×©×¨: [×˜×œ×¤×•×Ÿ ×—×‘×¨×”].**', category: '×ª××™×›×”', placeholders: ['×©× ×œ×§×•×—', '××¡×¤×¨ ××›×•×œ×”', '×˜×œ×¤×•×Ÿ ×—×‘×¨×”'], emoji: 'ğŸ”§' },
            { id: 'general_thanks', text: '×ª×•×“×” ×¨×‘×” ×œ×š, **[×©× ×œ×§×•×—]**, ×¢×œ ×©×™×ª×•×£ ×”×¤×¢×•×œ×” ×•×”×××•×Ÿ ×‘[×©× ×”×—×‘×¨×”]! ğŸ™\n\n×× ×• ××¢×¨×™×›×™× ××ª ×‘×—×™×¨×ª×š ×‘× ×• ×•××§×•×•×™× ×œ×”××©×™×š ×œ×©×¨×ª ××•×ª×š × ××× ×”. ğŸ’–', category: '×›×œ×œ×™', placeholders: ['×©× ×œ×§×•×—', '×©× ×”×—×‘×¨×”'], emoji: 'ğŸ˜Š' },
            { id: 'multi_container_reminder', text: '×©×œ×•× **[×©× ×œ×§×•×—]**,\n\n×©×× ×• ×œ×‘ ×©×‘×¨×©×•×ª×š **××¡×¤×¨ ××›×•×œ×•×ª ×¤×¢×™×œ×•×ª** ğŸ—ï¸. ×× ×• ×›××Ÿ ×›×“×™ ×œ×•×•×“× ×©×›×œ ×”×¦×¨×›×™× ×©×œ×š ××¡×•×¤×§×™×.\n\n×”×× ×™×© ××©×”×• ×©× ×•×›×œ ×œ×¢×–×•×¨ ×‘×• ×‘× ×•×’×¢ ×œ××›×•×œ×•×ª ×©×œ×š? ××œ ×ª×”×¡×¡ ×œ×¤× ×•×ª! ğŸ¤', category: '×ª×–×›×•×¨×•×ª', placeholders: ['×©× ×œ×§×•×—'], emoji: 'ğŸ“¦' },
            { id: 'container_mismatch', text: '×©×œ×•× **[×©× ×œ×§×•×—]**,\n\n**×”×ª×¨××”:** ××›×•×œ×” ××¡×¤×¨ **[××¡×¤×¨ ××›×•×œ×”]** ×™×¨×“×” ××¦×œ ×œ×§×•×— **[×©× ×œ×§×•×—]** ×‘×ª×¢×•×“×” **[×ª×¢×•×“×”]** ×œ×¤× ×™ **[×™××™× ×©×¢×‘×¨×•]** ×™××™× ×•×˜×¨× ×”×•×—×–×¨×”/× ×¡×’×¨×”! ğŸš¨', category: '×—×¨×™×’×•×ª', placeholders: ['×©× ×œ×§×•×—', '××¡×¤×¨ ××›×•×œ×”', '×ª×¢×•×“×”', '×™××™× ×©×¢×‘×¨×•'], emoji: 'ğŸš¨' },
            { id: 'pending_order_reminder', text: '×©×œ×•× **[×©× ×œ×§×•×—]**,\n\n**×‘×˜×™×¤×•×œ:** ×”×–×× ×” **[×ª×¢×•×“×”]** ×©×œ ×œ×§×•×— **[×©× ×œ×§×•×—]** ××¡×•×× ×ª "×‘×˜×™×¤×•×œ" ×•×œ× ×¢×•×“×›× ×” **[×™××™× ×©×¢×‘×¨×•]** ×™××™×. ×“×•×¨×© ×‘×“×™×§×”! âš ï¸', category: '×ª×–×›×•×¨×•×ª', placeholders: ['×©× ×œ×§×•×—', '×ª×¢×•×“×”', '×™××™× ×©×¢×‘×¨×•'], emoji: 'âš ï¸' }
        ];

        // City-specific guidelines for WhatsApp messages
        const cityGuidelines = {
            '×”×¨×¦×œ×™×”': {
                id: 'herzliya_permit',
                text: '×”× ×—×™×” ×—×©×•×‘×” ×œ×ª×•×©×‘×™ ×”×¨×¦×œ×™×”:\n×›×“×™ ×œ×”×¦×™×‘ ××›×•×œ×ª ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ ×‘×¨×—×•×‘ ×‘×”×¨×¦×œ×™×”, ×™×© ×œ×”×’×™×© ×‘×§×©×” ××¨××© ×œ××’×£ ×”×¤×™×§×•×— ×”×¢×™×¨×•× ×™. ×”×‘×§×©×” ×›×¨×•×›×” ×‘×ª×©×œ×•× ××’×¨×” ×•× ×“×¨×© ××™×©×•×¨ ×‘×›×ª×‘. ××•××œ×¥ ×œ×•×•×“× ××ª ×›×œ ×”×¤×¨×˜×™× ×‘××ª×¨ ×”×¢×™×¨×™×™×” ××• ×‘×˜×œ×¤×•×Ÿ.\n\n×§×™×©×•×¨ ×œ××™×“×¢: https://www.herzliya.muni.il/pages/%D7%90%D7%92%D7%A8%D7%95%D7%AA%20%D7%95%D7%94%D7%99%D7%AA%D7%A8%D7%99%D7%9D',
                link: 'https://www.herzliya.muni.il/pages/%D7%90%D7%92%D7%A8%D7%95%D7%AA%20%D7%95%D7%94%D7%99%D7%AA%D7%A8%D7%99%D7%9D',
                category: '×”×™×ª×¨×™× ×¢×™×¨×•× ×™×™×',
                placeholders: [],
                emoji: 'ğŸ“'
            },
            '×¨×¢× × ×”': {
                id: 'raanana_permit',
                text: '×”× ×—×™×” ×—×©×•×‘×” ×œ×ª×•×©×‘×™ ×¨×¢× × ×”:\n×‘×¨×¢× × ×”, ×—×œ ××™×¡×•×¨ ××•×—×œ×˜ ×œ×”×©××™×¨ ××›×•×œ×•×ª ×¤×¡×•×œ×ª ×‘× ×™×™×Ÿ ×‘××§×•× ×¦×™×‘×•×¨×™ (×‘×¨×—×•×‘) ×‘×¡×•×¤×™ ×©×‘×•×¢ ×•×‘×—×’×™×. ×™×© ×œ×“××•×’ ×œ×”×–××™×Ÿ ×¤×™× ×•×™ ×œ×¤× ×™ ×›× ×™×¡×ª ×”×©×‘×ª/×—×’. ×§× ×¡×•×ª ×™×™× ×ª× ×• ×œ××¤×¨×™×. ×× × ×”×§×¤×“ ×¢×œ ×”× ×—×™×•×ª ××œ×•.\n\n××™×“×¢ × ×•×¡×£: https://www.raanana.muni.il/pages/%D7%A4%D7%A1%D7%95%D7%9C%D7%AA-%D7%91%D7%A0%D7%99%D7%99%D7%9A',
                link: 'https://www.raanana.muni.il/pages/%D7%A4%D7%A1%D7%95%D7%9C%D7%AA-%D7%91%D7%A0%D7%99%D7%99%D7%9A',
                category: '×”×™×ª×¨×™× ×¢×™×¨×•× ×™×™×',
                placeholders: [],
                emoji: 'ğŸš«'
            },
            '×ª×œ ××‘×™×‘': {
                id: 'telaviv_permit',
                text: '×”× ×—×™×” ×—×©×•×‘×” ×œ×ª×•×©×‘×™ ×ª×œ ××‘×™×‘:\n×‘×ª×œ ××‘×™×‘, ×”×¦×‘×ª ××›×•×œ×•×ª ×¤×¡×•×œ×ª ×‘×¨×—×•×‘ ××—×™×™×‘×ª ×§×‘×œ×ª ×”×™×ª×¨ ××”×¢×™×¨×™×™×”. ×™×© ×œ×”×’×™×© ×‘×§×©×” ××§×•×•× ×ª ×•×œ×¦×¨×£ ××ª ×›×œ ×”××¡××›×™× ×”× ×“×¨×©×™×. ×©×™××• ×œ×‘ ×œ×”× ×—×™×•×ª ×”××“×•×™×§×•×ª ×œ×’×‘×™ ×¡×™××•×Ÿ ×”××›×•×œ×” ×•××©×š ×”×”×¦×‘×”.\n\n×œ××™×“×¢ ×•×”×’×©×ª ×‘×§×©×”: https://www.tel-aviv.muni.il/Bussiness/Construction/Pages/WasteContainers.aspx',
                link: 'https://www.tel-aviv.muni.il/Bussiness/Construction/Pages/WasteContainers.aspx',
                category: '×”×™×ª×¨×™× ×¢×™×¨×•× ×™×™×',
                placeholders: [],
                emoji: 'ï¿½ï¸'
            }
        };

        // Company information for placeholders
        const companyInfo = {
            phoneNumber: '972508860896', // Example WhatsApp number
            companyPhone: '097602010', // Example company phone
            companyName: '×—.×¡×‘×Ÿ' // Example company name
        };

        // Google Apps Script Web App URL for data interaction
        const SCRIPT_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbzk03pVBEBzHIWkFj1OzM0T5buH5cfNjD8njGza8AoKWulO1sPtiBrOpUZZItOd_gi/exec'; // Updated URL

        // Helper to generate consistent phone numbers for customers for static data
        const customerPhones = {};
        let nextPhoneNumber = 972501000000;
        const getCustomerPhone = (customerName) => {
            if (!customerPhones[customerName]) {
                customerPhones[customerName] = `97250${nextPhoneNumber++}`;
            }
            return customerPhones[customerName];
        };

        // Raw data from the provided "×˜×‘×œ×ª ×¤×¢×•×œ×•×ª ×××•×—×“×ª" (CSV format parsed to array of objects)
        const rawDataString = `
×ª××¨×™×š,×ª×¢×•×“×”,×©× ×œ×§×•×—,×©× ×¡×•×›×Ÿ,×¡×•×’ ×¤×¢×•×œ×”,×›×ª×•×‘×ª
2025-06-01,6712645,×‘×Ÿ ×¢× ×‘×¨-×‘×™"×¡ ×œ×™×™×“×™ ×“,×¨××™/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×©×§×“ 15, ×›×¤×¨ ×¡×‘×
2025-06-01,6712655,×©××¢×•×Ÿ ×”×¨××œ,×¨××™/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×’×œ×™×œ 10, ×”×¨×¦×œ×™×”
2025-06-01,6712656,×©××¨×§/× ××“×¨,×¨××™/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”××¨×– 3, ×¨×¢× × ×”
2025-06-01,6712659,× ×™×¨ ×•××™×¨×™ × ×•×‘×§,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”× ×©×™××™× 7, ×ª×œ ××‘×™×‘
2025-06-01,6712661,×‘×Ÿ ×¢× ×‘×¨-×‘×™"×¡ ×œ×™×™×“×™ ×“,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×©×§×“ 15, ×›×¤×¨ ×¡×‘×
2025-06-03,6712685,×¤×œ×— ××©×”/×›×œ×œ×™,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×™× 22, ××©×“×•×“
2025-06-03,6712689,××•×“×™ ×™×‘×•×/×‘× ×™ ×‘×¨×§,×¨××™/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×§×§"×œ 50, ×‘× ×™ ×‘×¨×§
2025-06-04,6712691,×”×›×œ ××‘×¨××©×™×ª/××•× ×™×‘×¨×¡×™,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×¢×¦×××•×ª 1, ×™×¨×•×©×œ×™×
2025-06-04,6712705,×“×•×“ ×—×™×™× ×•×‘× ×™×• - ×›×œ×œ,×¨××™/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”× ×¨×§×™×¡ 8, ×¨××©×•×Ÿ ×œ×¦×™×•×Ÿ
2025-06-05,6712709,×.×¢×¨×Ÿ ××–×•×œ××™ - ×™×”×•×“×”,×¨××™/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×‘×Ÿ ×’×•×¨×™×•×Ÿ 3, ×¤×ª×— ×ª×§×•×•×”
2025-06-05,6712713,×’×•× ×˜×›× ×™×§×” ×—×‘×¨×” ×œ×™×™×¦,×¨××™/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×¨×¦×œ 1, ×—×™×¤×”
2025-06-05,6712713,×’×•× ×˜×›× ×™×§×” ×—×‘×¨×” ×œ×™×™×¦,×¨××™/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×¨×¦×œ 1, ×—×™×¤×”
2025-06-05,6712718,×¢××¡×™ ××—××“ ×¢×‘ ×‘× ×™×Ÿ,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ××œ×•×Ÿ 12, × ×¦×¨×ª
2025-06-05,6712721,××œ× ×‘×™ ×¢×œ ×”×™×/×”××’×“×”,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×“×™×–× ×’×•×£ 90, ×ª×œ ××‘×™×‘
2025-06-10,6712739,××•×“×™ ×™×‘×•×/×‘× ×™ ×‘×¨×§,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×§×§"×œ 50, ×‘× ×™ ×‘×¨×§
2025-06-10,6712744,××•×”×“ ×˜×œ,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×“×§×œ 5, ×‘××¨ ×©×‘×¢
2025-06-11,6712750,×”×›×œ ××‘×¨××©×™×ª/××•× ×™×‘×¨×¡×™,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×¢×¦×××•×ª 1, ×™×¨×•×©×œ×™×
2025-06-11,6712755,×”×›×œ ××‘×¨××©×™×ª/××•× ×™×‘×¨×¡×™,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×¢×¦×××•×ª 1, ×™×¨×•×©×œ×™×
2025-06-11,6712760,×.×¦ ×©×—×™×‘×¨ ×‘× ×™×” ×‘×¢"×,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”××™×™×¡×“×™× 2, ×—×•×œ×•×Ÿ
2025-06-12,6712766,×”×›×œ ××‘×¨××©×™×ª/××•× ×™×‘×¨×¡×™,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×¢×¦×××•×ª 1, ×™×¨×•×©×œ×™×
2025-06-12,6712774,×©×—×¨ ×©××•×œ ×ª×›× ×•×Ÿ/×›×œ×œ×™,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”××•×¨×Ÿ 1, ×¨××ª ×’×Ÿ
2025-06-13,6712778,×¤×™× ×•×™ ×¤×¡×•×œ×ª ×‘×©×¨×•×Ÿ ×‘×¢,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×¤×¨×—×™× 10, × ×ª× ×™×”
2025-06-17,6712823,×‘.×¨.×© ×ª×—×–×•×§×ª ××¨×œ×•×’×™×,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×ª×¢×©×™×™×” 1, ×œ×•×“
2025-06-17,6712834,×§×‘×•×¦×ª ×—×¡×•×Ÿ,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×’×œ×‘×•×¢ 5, ×¢×¤×•×œ×”
2025-06-18,6712849,××™×™ ×“×¡×§ ×‘×¢"×,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”××œ×•× ×™× 7, ×¨×—×•×‘×•×ª
2025-06-19,6712877,×¢.×“×¨×§×•,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”××œ××›×” 14, ×¨××œ×”
2025-06-20,6712886,×©×—×¨ ×©××•×œ ×ª×›× ×•×Ÿ/×›×œ×œ×™,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”××•×¨×Ÿ 1, ×¨××ª ×’×Ÿ
2025-06-22,6712906,×¤×™× ×•×™ ×¤×¡×•×œ×ª ×‘×©×¨×•×Ÿ ×‘×¢,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×¤×¨×—×™× 10, × ×ª× ×™×”
2025-06-24,6712954,×.×¢×¨×Ÿ ××–×•×œ××™ - ×§×™×“××”,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×’×™×‘×•×¨×™× 2, ×—×“×¨×”
2025-06-25,6712979,×”×›×œ ××‘×¨××©×™×ª/××•× ×™×‘×¨×¡×™,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×¢×¦×××•×ª 1, ×™×¨×•×©×œ×™×
2025-06-25,6713984,×¤×™× ×ª ×‘××–×œ (×™×‘×’× ×™),××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×ª×× ×” 3, ×‘××¨ ×©×‘×¢
2025-06-26,6713998,×¤×™× ×ª ×‘××–×œ (×™×‘×’× ×™),××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×ª×× ×” 3, ×‘××¨ ×©×‘×¢
2025-06-27,6713043,×‘×™×œ×™××•×¨ ×™×¦×—×§×™-×›×œ×œ×™,×¨×™×™××•× ×“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×—×‘×¦×œ×ª 9, ×§×¨×™×™×ª ××•× ×•
2025-06-29,6713053,×¤×™× ×ª ×‘××–×œ (×™×‘×’× ×™),××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×ª×× ×” 3, ×‘××¨ ×©×‘×¢
2025-06-29,6713064,×œ×™××•×¨ ×™×¦×—×§×™-×§×™×‘×•×¥ ×¢×™,××•×—××“/×©××¨×§,×”×•×¦××”,×§×™×‘×•×¥ ×¢×™× ×ª, ×›×¤×¨ ×¡×‘×
2025-06-30,6713084,××•×“×™ ×™×‘×•×/×‘× ×™ ×‘×¨×§,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×§×§"×œ 50, ×‘× ×™ ×‘×¨×§
2025-06-30,6713090,×.×¦ ×©×—×™×‘×¨ ×‘× ×™×” ×‘×¢"×,×¨××™/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”××™×™×¡×“×™× 2, ×—×•×œ×•×Ÿ
2025-06-30,6713091,××™×œ×Ÿ ×™×•×¡×£,×¨××™/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”××œ×” 4, × ×ª× ×™×”
2025-06-30,6713092,××™×™ ×“×¡×§ ×‘×¢"×,×¨××™/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”××œ×•× ×™× 7, ×¨×—×•×‘×•×ª
2025-06-30,6713094,×¢.×“×¨×§×•,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”××œ××›×” 14, ×¨××œ×”
2025-07-01,6713107,××•×–×¡ ×¡×¨× ×’×”,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×ª×§×•××” 1, ××™×œ×ª
2025-07-01,6713111,× ×“×œ×¡×˜×™×¦'×¨ ××™×ª×™/×œ×•×˜×,×¨××™/×©××¨×§,×”×¦×‘×”,×¨×—×•×‘ ×”× ×’×‘ 20, ×“×™××•× ×”
2025-07-01,6713123,××•×“×™ ×™×‘×•×/×‘× ×™ ×‘×¨×§,×¨××™/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×§×§"×œ 50, ×‘× ×™ ×‘×¨×§
2025-07-02,6713131,×”×›×œ ××‘×¨××©×™×ª/××•× ×™×‘×¨×¡×™,××•×—××“/×©××¨×§,×”×¦×‘×”,×¨×—×•×‘ ×”×¢×¦×××•×ª 1, ×™×¨×•×©×œ×™×
2025-07-02,6713132,×¢×•×¤×¨ ×¤×•×‘×™×¦×¨,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×©×œ×•× 1, ×‘××¨ ×©×‘×¢
2025-07-02,6713137,×‘×–×œ×ª ××–×¨ ×‘×¢"×,××•×—××“/×©××¨×§,×”×¦×‘×”,×¨×—×•×‘ ×”×¦×™×•× ×•×ª 5, × ×¡ ×¦×™×•× ×”
2025-07-02,6713146,×.×¢×¨×Ÿ ××–×•×œ××™ - ×§×™×“××”,×¨××™/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×’×™×‘×•×¨×™× 2, ×—×“×¨×”
2025-07-02,6713150,×.×›.×¨×™××•× ×™×/××œ×›×™ ×”×¨×¦,××•×—××“/×©××¨×§,×”×¦×‘×”,×¨×—×•×‘ ×”××œ×›×™× 1, ×”×¨×¦×œ×™×”
2025-07-02,6713151,××•×“×™ ×™×‘×•×/×‘× ×™ ×‘×¨×§,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×§×§"×œ 50, ×‘× ×™ ×‘×¨×§
2025-07-02,6713129,×©××¢×•×Ÿ ×”×¨××œ,×¨××™/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×’×œ×™×œ 10, ×”×¨×¦×œ×™×”
2025-07-02,6713129,×©××¢×•×Ÿ ×”×¨××œ,×¨××™/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×’×œ×™×œ 10, ×”×¨×¦×œ×™×”
2025-07-03,6713166,×¤×™× ×•×™ ×¤×¡×•×œ×ª ×‘×©×¨×•×Ÿ ×‘×¢,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×¤×¨×—×™× 10, × ×ª× ×™×”
2025-07-03,6713179,××•×¨× ×”× ×“×¡×” ×•× ×™×”×•×œ ×‘×¢,××•×—××“/×©××¨×§,×”×¦×‘×”,×¨×—×•×‘ ×”× ×“×¡×” 1, ×›×¤×¨ ×¡×‘×
2025-07-06,6713195,×‘×Ÿ ×¢× ×‘×¨-×§×¨×™×ª ××•× ×•,××•×—××“/×©××¨×§,×”×¦×‘×”,×¨×—×•×‘ ×”×—×‘×¦×œ×ª 9, ×§×¨×™×™×ª ××•× ×•
2025-07-06,6713198,×©×—×¨ ×©××•×œ ×ª×›× ×•×Ÿ/×›×œ×œ×™,×¨××™/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”××•×¨×Ÿ 1, ×¨××ª ×’×Ÿ
2025-07-06,6713201,×™×•× ×ª×Ÿ ×× ×©×”,××•×—××“/×©××¨×§,×”×¦×‘×”,×¨×—×•×‘ ×”×’×¤×Ÿ 3, ×”×•×“ ×”×©×¨×•×Ÿ
2025-07-06,6713205,××•×¨× ×”× ×“×¡×” ×•× ×™×”×•×œ ×‘×¢,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”× ×“×¡×” 1, ×›×¤×¨ ×¡×‘×
2025-07-07,6713225,×”×›×œ ××‘×¨××©×™×ª/××•× ×™×‘×¨×¡×™,×¨××™/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×¢×¦×××•×ª 1, ×™×¨×•×©×œ×™×
2025-07-07,6713232,×‘×Ÿ ×¢× ×‘×¨-×§×¨×™×ª ××•× ×•,××•×—××“/×©××¨×§,×”×¦×‘×”,×¨×—×•×‘ ×”×—×‘×¦×œ×ª 9, ×§×¨×™×™×ª ××•× ×•
2025-07-07,6713237,×©×—×¨ ×©××•×œ ×ª×›× ×•×Ÿ/×›×œ×œ×™,×¨××™/×©××¨×§,×”×¦×‘×”,×¨×—×•×‘ ×”××•×¨×Ÿ 1, ×¨××ª ×’×Ÿ
2025-07-07,6713238,×§×•×‘×™ ×‘× ×™×©×•,×¨××™/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×©×§×“ 1, ×‘××¨ ×©×‘×¢
2025-07-07,6713243,×.×¢×¨×Ÿ ××–×•×œ××™ - ×§×™×“××”,××•×—××“/×©××¨×§,×”×¦×‘×”,×¨×—×•×‘ ×”×’×™×‘×•×¨×™× 2, ×—×“×¨×”
2025-07-07,6713244,×.×›.×¨×™××•× ×™×/××œ×›×™ ×”×¨×¦,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”××œ×›×™× 1, ×”×¨×¦×œ×™×”
2025-07-09,6713266,×”×›×œ ××‘×¨××©×™×ª/××•× ×™×‘×¨×¡×™,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×¢×¦×××•×ª 1, ×™×¨×•×©×œ×™×
2025-07-10,6713282,××•×“×™ ×™×‘×•×/×‘× ×™ ×‘×¨×§,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×§×§"×œ 50, ×‘× ×™ ×‘×¨×§
2025-07-10,6713285,×‘×–×œ×ª ××–×¨ ×‘×¢"×,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×¦×™×•× ×•×ª 5, × ×¡ ×¦×™×•× ×”
2025-07-10,6713288,×¨× ×™ ×©×™×¨××™,××•×—××“/×©××¨×§,×”×¦×‘×”,×¨×—×•×‘ ×”×“×•×œ×‘ 1, ××•×“×™×¢×™×Ÿ
2025-07-10,6713293,×¨× ×™ ×©×™×¨××™,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×“×•×œ×‘ 1, ××•×“×™×¢×™×Ÿ
2025-07-10,6713296,×”×›×œ ××‘×¨××©×™×ª/××•× ×™×‘×¨×¡×™,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×¢×¦×××•×ª 1, ×™×¨×•×©×œ×™×
2025-07-10,6713297,×‘×Ÿ ×¢× ×‘×¨-×§×¨×™×ª ××•× ×•,×¨××™/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×—×‘×¦×œ×ª 9, ×§×¨×™×™×ª ××•× ×•
2025-07-10,6713297,×‘×Ÿ ×¢× ×‘×¨-×§×¨×™×ª ××•× ×•,×¨××™/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×—×‘×¦×œ×ª 9, ×§×¨×™×™×ª ××•× ×•
2025-07-11,6713301,×.×¢×¨×Ÿ ××–×•×œ××™ - ×§×™×“××”,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×’×™×‘×•×¨×™× 2, ×—×“×¨×”
2025-07-11,6713302,×©×—×¨ ×œ×•×™,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”× ×“×™×‘ 10, ×¨×¢× × ×”
2025-07-11,6713304,×‘×Ÿ ×¢× ×‘×¨-×§×¨×™×ª ××•× ×•,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×—×‘×¦×œ×ª 9, ×§×¨×™×™×ª ××•× ×•
2025-07-11,6713306,×¨× ×™ ×©×™×¨××™,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×“×•×œ×‘ 1, ××•×“×™×¢×™×Ÿ
2025-07-13,6713311,×.×¦ ×©×—×™×‘×¨ ×‘× ×™×” ×‘×¢"×,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”××™×™×¡×“×™× 2, ×—×•×œ×•×Ÿ
2025-07-13,6713311,×.×¦ ×©×—×™×‘×¨ ×‘× ×™×” ×‘×¢"×,×¨××™/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”××™×™×¡×“×™× 2, ×—×•×œ×•×Ÿ
2025-07-13,6713313,×.×¦ ×©×—×™×‘×¨ ×‘× ×™×” ×‘×¢"×,×¨××™/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”××™×™×¡×“×™× 2, ×—×•×œ×•×Ÿ
2025-07-13,6713314,××œ× ×‘×™ ×¢×œ ×”×™×/×”××’×“×”,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×“×™×–× ×’×•×£ 90, ×ª×œ ××‘×™×‘
2025-07-13,6713322,××•×”×“ ×˜×œ,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×“×§×œ 5, ×‘××¨ ×©×‘×¢
2025-07-14,6713340,×‘×Ÿ ×¢× ×‘×¨-×‘×™"×¡ ×œ×™×™×“×™ ×“,××•×—××“/×©××¨×§,×”×¦×‘×”,×¨×—×•×‘ ×©×§×“ 15, ×›×¤×¨ ×¡×‘×
2025-07-14,6713356,××•×¨× ×™×œ-××©×¨ ×œ×•×™,×¨××™/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×ª×× ×” 1, ×—×“×¨×”
2025-07-15,6713365,×”×›×œ ××‘×¨××©×™×ª/××•× ×™×‘×¨×¡×™,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×¢×¦×××•×ª 1, ×™×¨×•×©×œ×™×
2025-07-15,6713368,×‘×Ÿ ×¢× ×‘×¨-×‘×™"×¡ ×œ×™×™×“×™ ×“,×¨××™/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×©×§×“ 15, ×›×¤×¨ ×¡×‘×
2025-07-15,6713370,×©×—×¨ ×©××•×œ ×ª×›× ×•×Ÿ/×›×œ×œ×™,××•×—××“/×©××¨×§,×”×¦×‘×”,×¨×—×•×‘ ×”××•×¨×Ÿ 1, ×¨××ª ×’×Ÿ
2025-07-15,6713372,×¤×œ×— ××©×”/×›×œ×œ×™,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×™× 22, ××©×“×•×“
2025-07-15,6713386,××•×–×¡ ×¡×¨× ×’×”,××•×—××“/×©××¨×§,×”×¦×‘×”,×¨×—×•×‘ ×”×ª×§×•××” 1, ××™×œ×ª
2025-07-15,6713388,×‘×”×¨ ××”×•×“-××‘×Ÿ ×™×”×•×“×”,×¨××™/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”××œ×•×Ÿ 1, ××‘×Ÿ ×™×”×•×“×”
2025-07-16,671339,×‘×–×œ×ª ××–×¨ ×‘×¢"×,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×¦×™×•× ×•×ª 5, × ×¡ ×¦×™×•× ×”
2025-07-16,6713395,×’×™× ×¤×¨×™×’×ª,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×©×–×™×£ 7, ×§×¨×™×™×ª ×’×ª
2025-07-16,6713411,×¤×™× ×•×™ ×¤×¡×•×œ×ª ×‘×©×¨×•×Ÿ ×‘×¢,×¨××™/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×¤×¨×—×™× 10, × ×ª× ×™×”
2025-07-20,6713466,×–×”×‘×™ ×™×¦×—×§,××•×—××“/×©××¨×§,×”×¦×‘×”,×¨×—×•×‘ ×”×–×”×‘ 1, × ×”×¨×™×”
2025-07-20,6713467,×–×”×‘×™ ×™×¦×—×§,××•×—××“/×©××¨×§,×”×¦×‘×”,×¨×—×•×‘ ×”×–×”×‘ 1, × ×”×¨×™×”
2025-07-20,6713475,×’×•× ×˜×›× ×™×§×” ×—×‘×¨×” ×œ×™×™×¦×•×¨ ×‘×¢"×,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×¨×¦×œ 1, ×—×™×¤×”
2025-07-20,6713475,×’×•× ×˜×›× ×™×§×” ×—×‘×¨×” ×œ×™×™×¦,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×¨×¦×œ 1, ×—×™×¤×”
2025-07-21,6713496,×”×›×œ ××‘×¨××©×™×ª/××•× ×™×‘×¨×¡×™,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×¢×¦×××•×ª 1, ×™×¨×•×©×œ×™×
2025-07-21,6713515,×–×”×‘×™ ×™×¦×—×§,××’×‘××¨×™×”/×©×,×”×—×œ×¤×”,×¨×—×•×‘ ×”×–×”×‘ 1, × ×”×¨×™×”
2025-07-21,6713518,×–×”×‘×™ ×™×¦×—×§,××’×‘××¨×™×”/×©×,×”×—×œ×¤×”,×¨×—×•×‘ ×”×–×”×‘ 1, × ×”×¨×™×”
2025-07-21,6713519,×©××¢×•×Ÿ ×”×¨××œ,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×’×œ×™×œ 10, ×”×¨×¦×œ×™×”
2025-07-21,6713519,×©××¢×•×Ÿ ×”×¨××œ,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×’×œ×™×œ 10, ×”×¨×¦×œ×™×”
2025-07-22,6713520,×¢××¡×™ ××—××“ ×¢×‘ ×‘× ×™×Ÿ,××’×‘××¨×™×”/×©×,×”×—×œ×¤×”,×¨×—×•×‘ ××œ×•×Ÿ 12, × ×¦×¨×ª
2025-07-22,6713523,××•×“×™ ×™×‘×•×/×‘× ×™ ×‘×¨×§,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×§×§"×œ 50, ×‘× ×™ ×‘×¨×§
2025-07-22,6713524,×–×”×‘×™ ×™×¦×—×§,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×–×”×‘ 1, × ×”×¨×™×”
2025-07-22,6713526,×‘×•×§×˜×•×¡ ××™×œ×Ÿ-×›×œ×œ×™,××’×‘××¨×™×”/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×¡×‘×™×•×Ÿ 6, ×¢×›×•
2025-07-22,6713527,×–×”×‘×™ ×™×¦×—×§,××’×‘××¨×™×”/×©××¨×§,×”×¦×‘×”,×¨×—×•×‘ ×”×–×”×‘ 1, × ×”×¨×™×”
2025-07-22,6713527,×–×”×‘×™ ×™×¦×—×§,××’×‘××¨×™×”/×©×,×”×•×¦××”,×¨×—×•×‘ ×”×–×”×‘ 1, × ×”×¨×™×”
2025-07-22,6713532,××™×™ ×“×¡×§ ×‘×¢"×,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”××œ×•× ×™× 7, ×¨×—×•×‘×•×ª
2025-07-22,6713533,×‘×Ÿ ×¢× ×‘×¨-×§×¨×™×ª ××•× ×•,××’×‘××¨×™×”/×©×,×”×•×¦××”,×¨×—×•×‘ ×”×—×‘×¦×œ×ª 9, ×§×¨×™×™×ª ××•× ×•
2025-07-24,6713566,××™×œ×Ÿ ×™×•×¡×£,××’×‘××¨×™×”/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”××œ×” 4, × ×ª× ×™×”
2025-07-24,6713571,×.×¢×¨×Ÿ ××–×•×œ××™ - ×× ×§×•×¨,××’×‘××¨×™×”/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×¢×•×’×Ÿ 1, ××©×“×•×“
2025-07-24,6713578,×©××¢×•×Ÿ ×”×¨××œ,××’×‘××¨×™×”/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×’×œ×™×œ 10, ×”×¨×¦×œ×™×”
2025-07-24,6713580,×©××¨×§/×¢×•××¨ ×¦××¤×™×•×Ÿ,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×¡×¤×•×¨×˜ 2, × ×ª× ×™×”
2025-07-25,6713586,×œ×™××•×¨ ×™×¦×—×§×™-×§×™×‘×•×¥ ×¢×™,××’×‘××¨×™×”/×©×,×”×—×œ×¤×”,×§×™×‘×•×¥ ×¢×™× ×ª, ×›×¤×¨ ×¡×‘×
2025-07-25,6713588,×œ×™××•×¨ ×™×¦×—×§×™-×§×™×‘×•×¥ ×¢×™,××’×‘××¨×™×”/×©×,×”×—×œ×¤×”,×§×™×‘×•×¥ ×¢×™× ×ª, ×›×¤×¨ ×¡×‘×
2025-07-27,6713599,××™×œ×Ÿ ×©×©×•×Ÿ,××’×‘××¨×™×”/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×ª×¤×•×– 8, ×”×•×“ ×”×©×¨×•×Ÿ
2025-07-27,6713600,×¤×™× ×•×™ ×¤×¡×•×œ×ª ×‘×©×¨×•×Ÿ ×‘×¢,××’×‘××¨×™×”/×©×,×”×•×¦××”,×¨×—×•×‘ ×”×¤×¨×—×™× 10, × ×ª× ×™×”
2025-07-28,6713622,×”×›×œ ××‘×¨××©×™×ª/××•× ×™×‘×¨×¡×™,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×¢×¦×××•×ª 1, ×™×¨×•×©×œ×™×
2025-07-28,6713628,×©××¨×§/× ××“×¨,××’×‘××¨×™×”/×©×,×”×—×œ×¤×”,×¨×—×•×‘ ×”××¨×– 3, ×¨×¢× × ×”
2025-07-28,6713628,×©××¨×§/× ××“×¨,××’×‘××¨×™×”/×©×,×”×—×œ×¤×”,×¨×—×•×‘ ×”××¨×– 3, ×¨×¢× × ×”
2025-07-28,6713640,××œ× ×‘×™ ×¢×œ ×”×™×/×”××’×“×”,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×“×™×–× ×’×•×£ 90, ×ª×œ ××‘×™×‘
2025-07-29,6713651,×”×›×œ ××‘×¨××©×™×ª/××•× ×™×‘×¨×¡×™,××’×‘××¨×™×”/×©×,×”×—×œ×¤×”,×¨×—×•×‘ ×”×¢×¦×××•×ª 1, ×™×¨×•×©×œ×™×
2025-07-29,6713658,××•×¨×‘×¨ ×‘× ×™×™×”/×™×¨××™×”×• ×¨"×’,××’×‘××¨×™×”/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×™×¨××™×”×• 1, ×¨××ª ×’×Ÿ
2025-07-29,6713661,××•×–×¡ ×¡×¨× ×’×”,××’×‘××¨×™×”/×©×,×”×•×¦××”,×¨×—×•×‘ ×”×ª×§×•××” 1, ××™×œ×ª
2025-07-29,6713670,×¢.×“×¨×§×•,××’×‘××¨×™×”/×©×,×”×—×œ×¤×”,×¨×—×•×‘ ×”××œ××›×” 14, ×¨××œ×”
2025-07-30,6713678,×©××¨×§/×¢×•××¨ ×¦××¤×™×•×Ÿ,××’×‘××¨×™×”/×©×,×”×—×œ×¤×”,×¨×—×•×‘ ×”×¡×¤×•×¨×˜ 2, × ×ª× ×™×”
2025-07-30,6713683,×™×•× ×ª×Ÿ ×× ×©×”,××’×‘××¨×™×”/×©×,×”×•×¦××”,×¨×—×•×‘ ×”×’×¤×Ÿ 3, ×”×•×“ ×”×©×¨×•×Ÿ
2025-07-30,671369,×©×—×¨ ×©××•×œ ×ª×›× ×•×Ÿ/×›×œ×œ×™,××’×‘××¨×™×”/×©×,×”×•×¦××”,×¨×—×•×‘ ×”××•×¨×Ÿ 1, ×¨××ª ×’×Ÿ
2025-07-31,6713705,×¨× ×™ ×©×™×¨××™,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×“×•×œ×‘ 1, ××•×“×™×¢×™×Ÿ
2025-07-31,6713722,×œ×™××•×¨ ×™×¦×—×§×™-×§×™×‘×•×¥ ×¢×™,××’×‘××¨×™×”/×©×,×”×•×¦××”,×§×™×‘×•×¥ ×¢×™× ×ª, ×›×¤×¨ ×¡×‘×
2025-08-01,6713730,××•×“×™ ×™×‘×•×/×‘× ×™ ×‘×¨×§,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×§×§"×œ 50, ×‘× ×™ ×‘×¨×§
2025-08-01,6713732,× ×“×œ×¡×˜×™×¦'×¨ ××™×ª×™/×œ×•×˜×,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”× ×’×‘ 20, ×“×™××•× ×”
2025-08-01,6713736,×¤×™× ×•×™ ×¤×¡×•×œ×ª ×‘×©×¨×•×Ÿ ×‘×¢,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×¤×¨×—×™× 10, × ×ª× ×™×”
2025-08-03,6713742,×××™×¨ ×§×™×Ÿ,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×ª××¨ 7, ×—×“×¨×”
2025-08-03,6713744,××œ×§××¨ ×œ×‘× ×™×” ×‘×¢"×,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×‘×•× ×™× 5, ×¤×ª×— ×ª×§×•×•×”
2025-08-03,6713745,×‘×–×œ×ª ××–×¨ ×‘×¢"×,××’×‘××¨×™×”/×©×,×”×•×¦××”,×¨×—×•×‘ ×”×¦×™×•× ×•×ª 5, × ×¡ ×¦×™×•× ×”
2025-08-03,6713755,×›×—×™×œ×” ×¦×—×™-×›×œ×œ×™,××•×—××“/×©××¨×§,×”×¦×‘×”,×¨×—×•×‘ ×”×–×™×ª 1, ×—×™×¤×”
2025-08-04,6713767,××•×“×™ ×™×‘×•×/×‘× ×™ ×‘×¨×§,××’×‘××¨×™×”/×©×,×”×—×œ×¤×”,×¨×—×•×‘ ×§×§"×œ 50, ×‘× ×™ ×‘×¨×§
2025-08-04,6713769,×‘×–×œ×ª ××–×¨ ×‘×¢"×,××’×‘××¨×™×”/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×¦×™×•× ×•×ª 5, × ×¡ ×¦×™×•× ×”
2025-08-04,6713771,×©×—×¨ ×©××•×œ ×ª×›× ×•×Ÿ/×›×œ×œ×™,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”××•×¨×Ÿ 1, ×¨××ª ×’×Ÿ
2025-08-04,6713771,×©×—×¨ ×©××•×œ ×ª×›× ×•×Ÿ/×›×œ×œ×™,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”××•×¨×Ÿ 1, ×¨××ª ×’×Ÿ
2025-08-05,6713801,×¨× ×™ ×©×™×¨××™,××’×‘××¨×™×”/×©×,×”×•×¦××”,×¨×—×•×‘ ×”×“×•×œ×‘ 1, ××•×“×™×¢×™×Ÿ
2025-08-06,6713827,×”×›×œ ××‘×¨××©×™×ª/××•× ×™×‘×¨×¡×™,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×¢×¦×××•×ª 1, ×™×¨×•×©×œ×™×
2025-08-06,6713831,×©××¨×§/××•×¨×Ÿ,××’×‘××¨×™×”/×©×,×”×—×œ×¤×”,×¨×—×•×‘ ×”××§×œ×™×¤×˜×•×¡ 9, ×¨×¢× × ×”
2025-08-07,6713844,×¤×™× ×•×™ ×¤×¡×•×œ×ª ×‘×©×¨×•×Ÿ ×‘×¢,××’×‘××¨×™×”/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×¤×¨×—×™× 10, × ×ª× ×™×”
2025-08-07,6713851,×™.×. × ×™×¡ ×‘×¢"×,××•×—××“/×©××¨×§,×”×¦×‘×”,×¨×—×•×‘ × ×™×¡×Ÿ 1, ×§×¨×™×™×ª ×’×ª
2025-08-07,6713853,××™×œ×Ÿ ×©×©×•×Ÿ,××’×‘××¨×™×”/×©××¨×§,×”×¦×‘×”,×¨×—×•×‘ ×”×ª×¤×•×– 8, ×”×•×“ ×”×©×¨×•×Ÿ
2025-08-08,6713881,×©× ×™ ××™×œ×ª×™/×›×œ×œ×™,××•×—××“/×©××¨×§,×”×¦×‘×”,×¨×—×•×‘ ×”××’×•×– 3, ×¨××ª ×”×©×¨×•×Ÿ
2025-08-09,6713891,××™×™ ×“×¡×§ ×‘×¢"×,××’×‘××¨×™×”/×©×,×”×—×œ×¤×”,×¨×—×•×‘ ×”××œ×•× ×™× 7, ×¨×—×•×‘×•×ª
2025-08-10,6713895,×’.×“ ××—×™× ×›×”×Ÿ ×‘×¢×,××’×‘××¨×™×”/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”××—×™× 2, ×‘××¨ ×©×‘×¢
2025-08-10,6713938,×”×›×œ ××‘×¨××©×™×ª/××•× ×™×‘×¨×¡×™,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×¢×¦×××•×ª 1, ×™×¨×•×©×œ×™×
2025-08-11,6713917,×‘×Ÿ ×¢× ×‘×¨-×§×¨×™×ª ××•× ×•,××’×‘××¨×™×”/×©×,×”×•×¦××”,×¨×—×•×‘ ×”×—×‘×¦×œ×ª 9, ×§×¨×™×™×ª ××•× ×•
2025-08-11,6713934,×‘×Ÿ ×¢× ×‘×¨-×§×¨×™×ª ××•× ×•,××’×‘××¨×™×”/×©×,×”×•×¦××”,×¨×—×•×‘ ×”×—×‘×¦×œ×ª 9, ×§×¨×™×™×ª ××•× ×•
2025-08-12,6713941,×©× ×™ ××™×œ×ª×™/×›×œ×œ×™,××’×‘××¨×™×”/×©×,×”×—×œ×¤×”,×¨×—×•×‘ ×”××’×•×– 3, ×¨××ª ×”×©×¨×•×Ÿ
2025-08-12,6713947,×™.×. × ×™×¡ ×‘×¢"×,××’×‘××¨×™×”/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ × ×™×¡×Ÿ 1, ×§×¨×™×™×ª ×’×ª
2025-08-13,6713971,×›×—×™×œ×” ×¦×—×™-×›×œ×œ×™,××’×‘××¨×™×”/×©×,×”×—×œ×¤×”,×¨×—×•×‘ ×”×–×™×ª 1, ×—×™×¤×”
2025-08-13,6713975,×©×—×¨ ×©××•×œ ×ª×›× ×•×Ÿ/×›×œ×œ×™,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”××•×¨×Ÿ 1, ×¨××ª ×’×Ÿ
2025-08-13,6713980,×©× ×™ ××™×œ×ª×™/×›×œ×œ×™,××’×‘××¨×™×”/×©×,×”×¦×‘×”,×¨×—×•×‘ ×”××’×•×– 3, ×¨××ª ×”×©×¨×•×Ÿ
2025-08-13,6713988,×××™×¨ ×§×™×Ÿ,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×ª××¨ 7, ×—×“×¨×”
2025-08-13,6713991,×›×—×™×œ×” ×¦×—×™-×›×œ×œ×™,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×–×™×ª 1, ×—×™×¤×”
2025-08-14,6714012,×©× ×™ ××™×œ×ª×™/×›×œ×œ×™,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”××’×•×– 3, ×¨××ª ×”×©×¨×•×Ÿ
2025-08-14,6714018,×©× ×™ ××™×œ×ª×™/×›×œ×œ×™,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”××’×•×– 3, ×¨××ª ×”×©×¨×•×Ÿ
2025-08-14,6714022,×©× ×™ ××™×œ×ª×™/×›×œ×œ×™,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”××’×•×– 3, ×¨××ª ×”×©×¨×•×Ÿ
2025-08-15,6714030,××•×“×™ ×™×‘×•×/×‘× ×™ ×‘×¨×§,××•×—××“/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×§×§"×œ 50, ×‘× ×™ ×‘×¨×§
2025-08-15,6714032,×©× ×™ ××™×œ×ª×™/×›×œ×œ×™,××’×‘××¨×™×”/×©×,×”×—×œ×¤×”,×¨×—×•×‘ ×”××’×•×– 3, ×¨××ª ×”×©×¨×•×Ÿ
2025-08-15,6714037,×‘×–×œ×ª ××–×¨ ×‘×¢"×,××’×‘××¨×™×”/×©××¨×§,×”×—×œ×¤×”,×¨×—×•×‘ ×”×¦×™×•× ×•×ª 5, × ×¡ ×¦×™×•× ×”
2025-08-17,6714041,×©× ×™ ××™×œ×ª×™/×›×œ×œ×™,××•×—××“/×©××¨×§,×”×¦×‘×”,×¨×—×•×‘ ×”××’×•×– 3, ×¨××ª ×”×©×¨×•×Ÿ
2025-08-17,6714051,××•×”×“ ×˜×œ,××’×‘××¨×™×”/×©×,×”×—×œ×¤×”,×¨×—×•×‘ ×”×“×§×œ 5, ×‘××¨ ×©×‘×¢
2025-08-17,6714058,×.×¦ ×©×—×™×‘×¨ ×‘× ×™×”/×”×•×“ ×”,××’×‘××¨×™×”/×©×,×”×•×¦××”,×¨×—×•×‘ ×”××™×™×¡×“×™× 2, ×—×•×œ×•×Ÿ
2025-08-17,6714059,×™×•× ×ª×Ÿ ×× ×©×”,××’×‘××¨×™×”/×©×,×”×¦×‘×”,×¨×—×•×‘ ×”×’×¤×Ÿ 3, ×”×•×“ ×”×©×¨×•×Ÿ
2025-08-17,6714063,×.×¦ ×©×—×™×‘×¨ ×‘× ×™×”/×”×•×“ ×”,××’×‘××¨×™×”/×©×,×”×•×¦××”,×¨×—×•×‘ ×”××™×™×¡×“×™× 2, ×—×•×œ×•×Ÿ
2025-08-18,6713988,×‘×•×§×˜×•×¡ ××™×œ×Ÿ-×›×œ×œ×™,××’×‘××¨×™×”/×©××¨×§,×”×¦×‘×”,×¨×—×•×‘ ×”×¡×‘×™×•×Ÿ 6, ×¢×›×•
2025-08-18,6714067,×‘×•×§×˜×•×¡ ××™×œ×Ÿ-×›×œ×œ×™,××•×—××“/×©××¨×§,×”×•×¦××”,×¨×—×•×‘ ×”×¡×‘×™×•×Ÿ 6, ×¢×›×•
`.trim();

        /**
         * Parses a CSV string into an array of objects.
         * @param {string} csvString - The CSV data as a string.
         * @returns {Array<Object>} An array of objects representing the CSV data.
         */
        const parseCSVString = (csvString) => {
            const lines = csvString.split('\n').map(line => line.trim()).filter(line => line.length > 0);
            if (lines.length === 0) return [];

            const headers = lines[0].split(',').map(h => h.trim());
            const data = [];

            for (let i = 1; i < lines.length; i++) {
                const values = [];
                let inQuote = false;
                let currentValue = '';
                for (let j = 0; j < lines[i].length; j++) {
                    const char = lines[i][j];
                    if (char === '"') {
                        inQuote = !inQuote;
                    } else if (char === ',' && !inQuote) {
                        values.push(currentValue.trim());
                        currentValue = '';
                    } else {
                        currentValue += char;
                    }
                }
                values.push(currentValue.trim()); // Push the last value

                const rowObject = {};
                for (let k = 0; k < headers.length; k++) {
                    rowObject[headers[k]] = values[k] !== undefined ? values[k] : '';
                }
                data.push(rowObject);
            }
            return data;
        };

        const rawParsedData = parseCSVString(rawDataString);

        // Process raw static data into the desired structured format for historical operations
        historicalOperations = rawParsedData.map(row => {
            let actionType = row['×¡×•×’ ×¤×¢×•×œ×”'].trim();
            // Normalize action types
            if (actionType === '×”×•×¨×“×”') {
                actionType = '×”×¦×‘×”';
            } else if (actionType === '×”×¢×œ××”') {
                actionType = '×”×•×¦××”';
            } else if (actionType === '×”×—al×¤×”') { // Handle possible typo in static data
                actionType = '×”×—×œ×¤×”';
            }

            // For static data, container numbers are not in the raw CSV, so leave them empty.
            // They will be populated from live sheet data or new manual entries.
            const containerDropped = '';
            const containerLifted = '';
            const containerAll = '';

            const customerPhone = getCustomerPhone(row['×©× ×œ×§×•×—']); // Simulated phone numbers
            const orderDate = formatDate(row['×ª××¨×™×š']); // Parse date immediately

            let status = '×¤×ª×•×—';
            if (actionType === '×”×•×¦××”' || actionType === '×¤×™× ×•×™ ×‘××§×•×') {
                status = '×¡×’×•×¨';
            }

            // Calculate daysInRental and isOverdue for pre-computation
            const daysInRental = orderDate ? daysSince(orderDate) : 0;
            const isOverdue = status === '×¤×ª×•×—' && daysInRental >= 10;

            // Generate expected end date for open orders (e.g., 14 days from order date)
            const expectedEndDate = orderDate ? new Date(orderDate.getTime() + 14 * 24 * 60 * 60 * 1000) : null;
            const expectedEndDateFormatted = expectedEndDate ? formatISODate(expectedEndDate) : '';

            // Ensure all headers expected by the Google Sheet are present, even if empty
            // This structure mirrors the `sheetHeaders` in submitNewOrder for consistency.
            const completeOrder = {
                '×ª××¨×™×š ×”×–×× ×”': orderDate,
                '×ª×¢×•×“×”': row['×ª×¢×•×“×”'],
                '×©× ×¡×•×›×Ÿ': row['×©× ×¡×•×›×Ÿ'],
                '×©× ×œ×§×•×—': row['×©× ×œ×§×•×—'],
                '×›×ª×•×‘×ª': row['×›×ª×•×‘×ª'] || '', // Use provided address, or empty string
                '×¡×•×’ ×¤×¢×•×œ×”': actionType,
                '×™××™× ×©×¢×‘×¨×•': daysInRental, // Pre-calculated
                '××¡×¤×¨ ××›×•×œ×” ×™×¨×“×”': containerDropped,
                '××¡×¤×¨ ××›×•×œ×” ×¢×œ×ª×”': containerLifted,
                '××¡×¤×¨×™ ××›×•×œ×•×ª': containerAll,
                '×¡×˜×˜×•×¡': status,
                '×”×¢×¨×•×ª': '',
                '×ª××¨×™×š ×¡×™×•× ×¦×¤×•×™': expectedEndDate,
                '×”×¢×¨×•×ª ×¡×™×•×': '',
                '×ª××¨×™×š ×¡×’×™×¨×”': status === '×¡×’×•×¨' ? orderDate : null, // Set closing date if status is closed
                '×™××™× ×©×¢×‘×¨×• (×¢×œ×ª×”)': '', // Not calculated for static data without explicit lifted dates
                '×˜×œ×¤×•×Ÿ ×œ×§×•×—': customerPhone,
                'isOverdue': isOverdue // Pre-calculated
            };
            return completeOrder;
        });
        console.log("Loaded static historical data (without simulated container numbers):", historicalOperations);

        /**
         * Builds a comprehensive ledger for each container, determining its current status
         * and full historical movement.
         */
        const buildContainerLedger = () => {
            containerLedger = {}; // Reset for fresh build

            // 1. First pass: Populate raw history for each container
            // Sort all operations by date (ascending) to correctly build history
            const sortedOperations = allOperations.slice().sort((a, b) => {
                const dateA = a['×ª××¨×™×š ×”×–×× ×”'] ? a['×ª××¨×™×š ×”×–×× ×”'].getTime() : 0;
                const dateB = b['×ª××¨×™×š ×”×–×× ×”'] ? b['×ª××¨×™×š ×”×–×× ×”'].getTime() : 0;
                return dateA - dateB;
            });

            sortedOperations.forEach(op => {
                const docId = String(op['×ª×¢×•×“×”']);
                const customerName = op['×©× ×œ×§×•×—'];
                const address = op['×›×ª×•×‘×ª'];
                const opDate = op['×ª××¨×™×š ×”×–×× ×”'];
                const actionType = op['×¡×•×’ ×¤×¢×•×œ×”'];

                // Split by comma for multiple containers
                const containersDropped = String(op['××¡×¤×¨ ××›×•×œ×” ×™×¨×“×”'] || '').split(',').map(c => c.trim()).filter(Boolean);
                const containersLifted = String(op['××¡×¤×¨ ××›×•×œ×” ×¢×œ×ª×”'] || '').split(',').map(c => c.trim()).filter(Boolean);

                containersDropped.forEach(containerNum => {
                    if (!containerLedger[containerNum]) {
                        containerLedger[containerNum] = { history: [], currentStatus: 'unknown', currentCustomer: null, currentAddress: null, lastDroppedDate: null, lastLiftedDate: null, nextDropDate: null, latestOperationDocId: null };
                    }
                    containerLedger[containerNum].history.push({
                        type: 'dropped',
                        customer: customerName,
                        date: opDate,
                        docId: docId,
                        address: address,
                        actionType: actionType // Store action type for history display
                    });
                });

                containersLifted.forEach(containerNum => {
                    if (!containerLedger[containerNum]) {
                        containerLedger[containerNum] = { history: [], currentStatus: 'unknown', currentCustomer: null, currentAddress: null, lastDroppedDate: null, lastLiftedDate: null, nextDropDate: null, latestOperationDocId: null };
                    }
                    containerLedger[containerNum].history.push({
                        type: 'lifted',
                        customer: customerName, // Customer it was lifted FROM
                        date: opDate,
                        docId: docId,
                        address: address,
                        actionType: actionType // Store action type for history display
                    });
                });
            });

            // 2. Second pass: Determine current status and enrich container info
            for (const containerNum in containerLedger) {
                const container = containerLedger[containerNum];
                container.history.sort((a, b) => a.date.getTime() - b.date.getTime()); // Ensure history is sorted chronologically

                const lastEvent = container.history[container.history.length - 1];

                if (lastEvent) {
                    container.latestOperationDocId = lastEvent.docId; // Keep track of the operation that caused the current state

                    if (lastEvent.type === 'dropped') {
                        container.currentStatus = 'in_use';
                        container.currentCustomer = lastEvent.customer;
                        container.currentAddress = lastEvent.address;
                        container.lastDroppedDate = lastEvent.date;
                        container.lastLiftedDate = null; // Reset if dropped
                        container.nextDropDate = null; // Reset if dropped (it's currently in use)
                        container.nextDropCustomer = null;
                        container.nextDropAddress = null;
                    } else if (lastEvent.type === 'lifted') {
                        container.lastLiftedDate = lastEvent.date;
                        container.lastDroppedDate = null; // Reset if lifted

                        // Check for a future 'dropped' event after the last 'lifted' event
                        const indexOfLastLifted = container.history.indexOf(lastEvent);
                        const futureDrop = container.history.slice(indexOfLastLifted + 1).find(event => event.type === 'dropped');

                        if (futureDrop) {
                            container.currentStatus = 'in_transit'; // lifted but will be dropped elsewhere soon
                            container.currentCustomer = lastEvent.customer; // Last customer it was with
                            container.currentAddress = lastEvent.address; // Last address it was at
                            container.nextDropDate = futureDrop.date;
                            container.nextDropCustomer = futureDrop.customer;
                            container.nextDropAddress = futureDrop.address;
                        } else {
                            container.currentStatus = 'available'; // lifted and no future drops
                            container.currentCustomer = null; // No current customer
                            container.currentAddress = null;
                            container.nextDropDate = null;
                            container.nextDropCustomer = null;
                            container.nextDropAddress = null;
                        }
                    }
                } else {
                    container.currentStatus = 'unknown'; // Fallback if no events found for container (shouldn't happen with current data)
                }
            }
            console.log("Built container ledger:", containerLedger);
        };


        /**
         * Merges historical static data with live data fetched from Google Sheet.
         * Prioritizes live data for documents with matching '×ª×¢×•×“×”'.
         * Converts date strings from live data to Date objects.
         * @param {Array<Object>} staticOps - Array of historical operation objects.
         * @param {Array<Object>} liveOps - Array of live operation objects from Google Sheet.
         * @returns {Array<Object>} Merged and sorted array of operations.
         */
        const mergeData = (staticOps, liveOps) => {
            const mergedMap = new Map();

            // Add live data, prioritizing it
            liveOps.forEach(op => {
                const docId = String(op['×ª×¢×•×“×”']);
                // Apply the user's mapping for live data from sheet and parse dates
                let normalizedActionType = op['×¡×•×’ ×¤×¢×•×œ×”'] ? op['×¡×•×’ ×¤×¢×•×œ×”'].trim() : '';
                if (normalizedActionType === '×”×•×¨×“×”') {
                    normalizedActionType = '×”×¦×‘×”';
                } else if (normalizedActionType === '×”×¢×œ××”') {
                    normalizedActionType = '×”×•×¦××”';
                }
                op['×¡×•×’ ×¤×¢×•×œ×”'] = normalizedActionType; // Update the operation object

                // Parse dates into Date objects
                op['×ª××¨×™×š ×”×–×× ×”'] = formatDate(op['×ª××¨×™×š ×”×–×× ×”']);
                op['×ª××¨×™×š ×¡×™×•× ×¦×¤×•×™'] = formatDate(op['×ª××¨×™×š ×¡×™×•× ×¦×¤×•×™']);
                op['×ª××¨×™×š ×¡×’×™×¨×”'] = formatDate(op['×ª××¨×™×š ×¡×’×™×¨×”']);

                // Calculate derived fields (daysInRental, isOverdue)
                op['×™××™× ×©×¢×‘×¨×•'] = op['×ª××¨×™×š ×”×–×× ×”'] ? daysSince(op['×ª××¨×™×š ×”×–×× ×”']) : 0;
                op['isOverdue'] = op['×¡×˜×˜×•×¡'] !== '×¡×’×•×¨' && op['×™××™× ×©×¢×‘×¨×•'] >= 10;

                mergedMap.set(docId, op);
            });

            // Add historical data if not already present in live data
            staticOps.forEach(op => {
                const docId = String(op['×ª×¢×•×“×”']);
                if (!mergedMap.has(docId)) {
                    mergedMap.set(docId, op); // Static data already has parsed dates and calculated fields
                }
            });

            // Convert map back to array and sort by date (descending)
            return Array.from(mergedMap.values()).sort((a, b) => {
                const dateA = a['×ª××¨×™×š ×”×–×× ×”'] ? a['×ª××¨×™×š ×”×–×× ×”'].getTime() : 0;
                const dateB = b['×ª××¨×™×š ×”×–×× ×”'] ? b['×ª××¨×™×š ×”×–×× ×”'].getTime() : 0;
                return dateB - dateA;
            });
        };


        /**
         * Fetches data from the Google Sheet with exponential backoff for retries.
         * @async
         */
        const fetchDataFromGoogleSheet = async () => {
            isLoadingData = true;
            document.getElementById('global-loader').classList.remove('hidden'); // Show loader

            let liveData = [];
            let retries = 0;
            const maxRetries = 5;
            const baseDelay = 1000; // 1 second

            while (retries < maxRetries) {
                try {
                    const response = await fetch(`${SCRIPT_WEB_APP_URL}?action=getData`);
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const result = await response.json();

                    if (result.success && Array.isArray(result.data)) {
                        liveData = result.data;
                        console.log("Fetched live data from Google Sheet:", liveData);
                        break; // Exit retry loop on success
                    } else {
                        console.error("Received data is not an array or success is false:", result);
                        showStatusMessage("×©×’×™××”: ×”× ×ª×•× ×™× ×©×”×ª×§×‘×œ×• ××’×™×œ×™×•×Ÿ ×’×•×’×œ ××™× × ×‘×¤×•×¨××˜ ×¦×¤×•×™ ××• ×©×”×™×™×ª×” ×©×’×™××” ×‘×©×¨×ª: " + (result.message || '××™×Ÿ ×”×•×“×¢×” ×¡×¤×¦×™×¤×™×ª'), 'error');
                        // No break here, allow retry for server errors potentially
                    }
                } catch (error) {
                    console.error("Error fetching data from Google Sheet:", error);
                    showStatusMessage("×©×’×™××” ×‘×˜×¢×™× ×ª ×”× ×ª×•× ×™× ××’×™×œ×™×•×Ÿ ×’×•×’×œ: " + error.message, 'error');
                }

                if (retries < maxRetries - 1) { // Don't delay after the last retry attempt
                    const delay = baseDelay * Math.pow(2, retries);
                    // console.warn(`API rate limit hit or network error. Retrying in ${delay / 1000} seconds... (attempt ${retries + 1})`);
                    await new Promise(resolve => setTimeout(resolve, delay));
                }
                retries++;
            }

            // Merge historical static data with live data
            allOperations = mergeData(historicalOperations, liveData);
            console.log("Merged operations data:", allOperations);

            // Build the container ledger after all operations are merged
            buildContainerLedger();

            renderDashboard();
            renderInventory();
            renderTreatmentBoard();
            renderTopOverdueCustomers(); // Render new KPI cards

            isLoadingData = false;
            document.getElementById('global-loader').classList.add('hidden'); // Hide loader
        };

        /**
         * Adds a new order to the Google Sheet via Apps Script.
         * @param {Object} orderData - The order data to send.
         * @async
         */
        const addNewOrderToSheet = async (orderData) => {
            document.getElementById('global-loader').classList.remove('hidden'); // Show loader
            try {
                const response = await fetch(`${SCRIPT_WEB_APP_URL}?action=addOrder`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(orderData)
                });
                const result = await response.json();
                if (result.success) {
                    showStatusMessage('×”×”×–×× ×” × ×•×¡×¤×” ×‘×”×¦×œ×—×” ×œ×’×™×œ×™×•×Ÿ!', 'success');
                    await fetchDataFromGoogleSheet(); // Re-fetch all data to ensure local state is updated
                } else {
                    showStatusMessage('×©×’×™××” ×‘×”×•×¡×¤×ª ×”×”×–×× ×”: ' + result.message, 'error');
                }
            } catch (error) {
                console.error('Error adding order to sheet:', error);
                showStatusMessage('×©×’×™××” ×‘×ª×§×©×•×¨×ª ×¢× ×”×©×¨×ª ×‘×¢×ª ×”×•×¡×¤×ª ×”×–×× ×”.', 'error');
            } finally {
                document.getElementById('global-loader').classList.add('hidden'); // Hide loader
            }
        };

        /**
         * Updates an existing order in the Google Sheet via Apps Script.
         * @param {string} originalDocId - The original document ID of the order to update.
         * @param {Object} updatedOrderDatï¿½
